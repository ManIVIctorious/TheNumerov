<!DOCTYPE html>
<!--[if IE 6]>
<html id="ie6" lang="en-US">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 6) & !(IE 7) & !(IE 8)]><!-->
<html lang="en-US"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">


<title>Image Processing - Bicubic Spline Interpolation | GIASSA.NET</title>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="stylesheet" type="text/css" media="all" href="giassia-Dateien/style.css">
<link rel="pingback" href="http://www.giassa.net/xmlrpc.php">
<!--[if lt IE 9]>
<script src="http://www.giassa.net/wp-content/themes/twentyeleven/js/html5.js" type="text/javascript"></script>
<![endif]-->

<!-- All in One SEO Pack 2.3.8 by Michael Torbert of Semper Fi Web Design[355,415] -->
<meta name="description" content="A tutorial on bicubic spline interpolation: a special case of bicubic interpolation.">

<meta name="keywords" content="image processing,matlab,cubic,bicubic,spline,interpolation,mri,giassa,matthew,sfu,engineering">

<link rel="canonical" href="http://www.giassa.net/?page_id=274">
<!-- /all in one seo pack -->
<link rel="alternate" type="application/rss+xml" title="GIASSA.NET » Feed" href="http://www.giassa.net/?feed=rss2">
<link rel="alternate" type="application/rss+xml" title="GIASSA.NET » Comments Feed" href="http://www.giassa.net/?feed=comments-rss2">
<link rel="alternate" type="application/rss+xml" title="GIASSA.NET » III – Bicubic Spline Interpolation Comments Feed" href="http://www.giassa.net/?feed=rss2&amp;page_id=274">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/www.giassa.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.5.4"}};
			!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;if(!g||!g.fillText)return!1;switch(g.textBaseline="top",g.font="600 32px Arial",a){case"flag":return g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3;case"diversity":return g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,d=c[0]+","+c[1]+","+c[2]+","+c[3],g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e;case"simple":return g.fillText(h(55357,56835),0,0),0!==g.getImageData(16,16,1,1).data[0];case"unicode8":return g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script type="text/javascript" src="giassia-Dateien/wp-emoji-release.js"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="crayon-css" href="giassia-Dateien/crayon.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-son-of-obsidian-css" href="giassia-Dateien/son-of-obsidian.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="giassia-Dateien/monaco.css" type="text/css" media="all">
<script type="text/javascript" src="giassia-Dateien/jquery_002.js"></script>
<script type="text/javascript" src="giassia-Dateien/jquery-migrate.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/www.giassa.net\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="giassia-Dateien/crayon.js"></script>
<script type="text/javascript" src="giassia-Dateien/jquery.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var IZ = {"with_woocommerce":"0","woo_categories":"0","lazy_load":"0","options":[]};
/* ]]> */
</script>
<script type="text/javascript" src="giassia-Dateien/image_zoom-init.js"></script>
<link rel="https://api.w.org/" href="http://www.giassa.net/?rest_route=/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.giassa.net/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.giassa.net/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 4.5.4">
<link rel="shortlink" href="http://www.giassa.net/?p=274">
<link rel="alternate" type="application/json+oembed" href="http://www.giassa.net/?rest_route=%2Foembed%2F1.0%2Fembed&amp;url=http%3A%2F%2Fwww.giassa.net%2F%3Fpage_id%3D274">
<link rel="alternate" type="text/xml+oembed" href="http://www.giassa.net/?rest_route=%2Foembed%2F1.0%2Fembed&amp;url=http%3A%2F%2Fwww.giassa.net%2F%3Fpage_id%3D274&amp;format=xml">
<style type="text/css">
/* <![CDATA[ */
img.latex { vertical-align: middle; border: none; }
/* ]]> */
</style>
</head>

<body class="page page-id-274 page-child parent-pageid-200 page-template-default single-author singular two-column right-sidebar">
<div id="page" class="hfeed">
	<header id="branding" role="banner">
			<hgroup>
				<h1 id="site-title"><span><a href="http://www.giassa.net/" rel="home">GIASSA.NET</a></span></h1>
				<h2 id="site-description">Engineering, DIY, and Everything Else</h2>
			</hgroup>

						<a href="http://www.giassa.net/">
									<img src="giassia-Dateien/image_banner_scaled.png" alt="GIASSA.NET" height="288" width="1000">
							</a>
			
								<form method="get" id="searchform" action="http://www.giassa.net/">
		<label for="s" class="assistive-text">Search</label>
		<input class="field" name="s" id="s" placeholder="Search" type="text">
		<input class="submit" name="submit" id="searchsubmit" value="Search" type="submit">
	</form>
			
			<nav id="access" role="navigation">
				<h3 class="assistive-text">Main menu</h3>
								<div class="skip-link"><a class="assistive-text" href="#content">Skip to primary content</a></div>
												<div class="menu"><ul><li><a href="http://www.giassa.net/">Home</a></li><li class="page_item page-item-865 page_item_has_children current_page_ancestor"><a href="http://www.giassa.net/?page_id=865">Projects</a><ul class="children"><li class="page_item page-item-1075 page_item_has_children"><a href="http://www.giassa.net/?page_id=1075">Algorithms</a><ul class="children"><li class="page_item page-item-1080"><a href="http://www.giassa.net/?page_id=1080">Base64 Encoder</a></li><li class="page_item page-item-1215"><a href="http://www.giassa.net/?page_id=1215">Finding “holes” in a sorted list of numbers</a></li><li class="page_item page-item-1203"><a href="http://www.giassa.net/?page_id=1203">Largest Sub-Square in a Binary Array</a></li><li class="page_item page-item-1120"><a href="http://www.giassa.net/?page_id=1120">Linked Lists</a></li><li class="page_item page-item-1031"><a href="http://www.giassa.net/?page_id=1031">Maze Generation &amp; Solving</a></li><li class="page_item page-item-1116"><a href="http://www.giassa.net/?page_id=1116">Stacks</a></li></ul></li><li class="page_item page-item-1274"><a href="http://www.giassa.net/?page_id=1274">Blacksmithing</a></li><li class="page_item page-item-880 page_item_has_children"><a href="http://www.giassa.net/?page_id=880">Bowyery</a><ul class="children"><li class="page_item page-item-1127"><a href="http://www.giassa.net/?page_id=1127">Bumblebee</a></li><li class="page_item page-item-1125"><a href="http://www.giassa.net/?page_id=1125">Heavy Longbow</a></li><li class="page_item page-item-1123"><a href="http://www.giassa.net/?page_id=1123">Heavy Pyramid Bow</a></li></ul></li><li class="page_item page-item-1078 page_item_has_children"><a href="http://www.giassa.net/?page_id=1078">Challenges &amp; Competitions</a><ul class="children"><li class="page_item page-item-867"><a href="http://www.giassa.net/?page_id=867">Eudyptula Challenge</a></li><li class="page_item page-item-869"><a href="http://www.giassa.net/?page_id=869">Matasanto Crypto Challenge</a></li></ul></li><li class="page_item page-item-878 page_item_has_children"><a href="http://www.giassa.net/?page_id=878">Homebrewing</a><ul class="children"><li class="page_item page-item-1163"><a href="http://www.giassa.net/?page_id=1163">Beer</a></li><li class="page_item page-item-1190"><a href="http://www.giassa.net/?page_id=1190">Mead</a></li></ul></li><li class="page_item page-item-118 page_item_has_children current_page_ancestor"><a href="http://www.giassa.net/?page_id=118">Image Processing Tutorials</a><ul class="children"><li class="page_item page-item-169"><a href="http://www.giassa.net/?page_id=169">0 – The Basics</a></li><li class="page_item page-item-174"><a href="http://www.giassa.net/?page_id=174">1 – Downsampling</a></li><li class="page_item page-item-200 page_item_has_children current_page_ancestor current_page_parent"><a href="http://www.giassa.net/?page_id=200">2 – Upsampling &amp; Interpolation</a><ul class="children"><li class="page_item page-item-207"><a href="http://www.giassa.net/?page_id=207">I – Nearest Neighbour Interpolation</a></li><li class="page_item page-item-240"><a href="http://www.giassa.net/?page_id=240">II – Bilinear Interpolation</a></li><li class="page_item page-item-274 current_page_item"><a href="http://www.giassa.net/?page_id=274">III – Bicubic Spline Interpolation</a></li><li class="page_item page-item-371"><a href="http://www.giassa.net/?page_id=371">IV – Generalized Bicubic Interpolation</a></li></ul></li><li class="page_item page-item-411 page_item_has_children"><a href="http://www.giassa.net/?page_id=411">3 – Histograms, Statistics, &amp; Single Pixel Operations</a><ul class="children"><li class="page_item page-item-470"><a href="http://www.giassa.net/?page_id=470">I – Histograms &amp; Statistics</a></li><li class="page_item page-item-472"><a href="http://www.giassa.net/?page_id=472">II – Contrast Adjustment &amp; Image Normalization</a></li><li class="page_item page-item-475"><a href="http://www.giassa.net/?page_id=475">III – Gamma Correction</a></li><li class="page_item page-item-477"><a href="http://www.giassa.net/?page_id=477">IV – Logarithmic Transformation</a></li><li class="page_item page-item-479"><a href="http://www.giassa.net/?page_id=479">V – Error Vectors</a></li></ul></li><li class="page_item page-item-584 page_item_has_children"><a href="http://www.giassa.net/?page_id=584">4 – Spatial Convolution Masks</a><ul class="children"><li class="page_item page-item-588"><a href="http://www.giassa.net/?page_id=588">I – Basic Masks</a></li><li class="page_item page-item-590"><a href="http://www.giassa.net/?page_id=590">II – Special Masks and Edge Detection</a></li></ul></li><li class="page_item page-item-237 page_item_has_children"><a href="http://www.giassa.net/?page_id=237">5 – Image Noise &amp; Spatial Domain Filtering</a><ul class="children"><li class="page_item page-item-635"><a href="http://www.giassa.net/?page_id=635">I – Salt &amp; Pepper Noise – Non-Linear Filtering</a></li><li class="page_item page-item-637"><a href="http://www.giassa.net/?page_id=637">II – Gaussian Noise – Linear Filtering</a></li><li class="page_item page-item-639"><a href="http://www.giassa.net/?page_id=639">III – Adaptive Filtering</a></li></ul></li></ul></li><li class="page_item page-item-1083 page_item_has_children"><a href="http://www.giassa.net/?page_id=1083">Software Projects</a><ul class="children"><li class="page_item page-item-1144"><a href="http://www.giassa.net/?page_id=1144">Brain Venctricle Analyzer</a></li><li class="page_item page-item-553"><a href="http://www.giassa.net/?page_id=553">ThunderVoice</a></li></ul></li><li class="page_item page-item-1129 page_item_has_children"><a href="http://www.giassa.net/?page_id=1129">Systems</a><ul class="children"><li class="page_item page-item-1154"><a href="http://www.giassa.net/?page_id=1154">AcousticAid</a></li><li class="page_item page-item-1131"><a href="http://www.giassa.net/?page_id=1131">Breast Cancer Screening Device</a></li><li class="page_item page-item-1158"><a href="http://www.giassa.net/?page_id=1158">SolarMax Wireless Charge Controller</a></li></ul></li><li class="page_item page-item-1219 page_item_has_children"><a href="http://www.giassa.net/?page_id=1219">Woodworking</a><ul class="children"><li class="page_item page-item-1221"><a href="http://www.giassa.net/?page_id=1221">“Thomas the Tank Engine” styled wagon</a></li><li class="page_item page-item-1277"><a href="http://www.giassa.net/?page_id=1277">Ana White “Tryde” Coffee Table</a></li><li class="page_item page-item-1265"><a href="http://www.giassa.net/?page_id=1265">Heavy duty workbench</a></li></ul></li></ul></li><li class="page_item page-item-17"><a href="http://www.giassa.net/?page_id=17">News</a></li><li class="page_item page-item-3"><a href="http://www.giassa.net/?page_id=3">Papers &amp; Publications</a></li><li class="page_item page-item-163"><a href="http://www.giassa.net/?page_id=163">DISCLAIMER</a></li></ul></div>
			</nav><!-- #access -->
	</header><!-- #branding -->


	<div id="main">

		<div id="primary">
			<div id="content" role="main">

				
					
<article id="post-274" class="post-274 page type-page status-publish hentry">
	<header class="entry-header">
		<h1 class="entry-title">III – Bicubic Spline Interpolation</h1>
	</header><!-- .entry-header -->

	<div class="entry-content">
		<p>Get ready for a long read on this one (it will be worth it though).</p>
<p>So, before proceeding with bicubic interpolation, we will examine the
 1D case first. In the case of of nearest neighbour or bilinear 
interpolation, we get a piecewise function that is continuous over small
 intervals. For nearest neighbour, we get constant, flat “spikes”. With 
bilinear interpolation, we get sections that are linear over a certain 
range, but have sharp discontinuities between these sections. We would 
like a piecewise interpolation function that is continuous over the 
entire interpolation interval.</p>
<p>First, I will generate a discrete sinusoid, shifted up by 1, as shown below:</p>
<p></p><div id="attachment_295" style="width: 351px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/0-sine-wave.png"><img class="size-full wp-image-295 " title="0-sine-wave" src="giassia-Dateien/0-sine-wave.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/0-sine-wave.png 568w, http://www.giassa.net/wp-content/uploads/2009/12/0-sine-wave-300x265.png 300w" sizes="(max-width: 341px) 100vw, 341px" height="301" width="341"></a><p class="wp-caption-text">Discrete Sinusoid [y=f(x)=sin(x)+1</p></div>Next, I will decimate values so that we have a lower resolution sinusoid (fewer samples available).<p></p>
<div id="attachment_296" style="width: 351px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/1-sine-wave-ds.png"><img class="size-full wp-image-296 " title="1-sine-wave-ds" src="giassia-Dateien/1-sine-wave-ds.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/1-sine-wave-ds.png 568w, http://www.giassa.net/wp-content/uploads/2009/12/1-sine-wave-ds-300x265.png 300w" sizes="(max-width: 341px) 100vw, 341px" height="301" width="341"></a><p class="wp-caption-text">Decimated Sinusoid</p></div>
<p>Now, I will first demonstrate, as shown previously, nearest neighbour 1D interpolation.</p>
<div id="attachment_297" style="width: 351px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/2-sine-wave-nn.png"><img class="size-full wp-image-297 " title="2-sine-wave-nn" src="giassia-Dateien/2-sine-wave-nn.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/2-sine-wave-nn.png 568w, http://www.giassa.net/wp-content/uploads/2009/12/2-sine-wave-nn-300x265.png 300w" sizes="(max-width: 341px) 100vw, 341px" height="301" width="341"></a><p class="wp-caption-text">Reconstructed Sinusoid – Nearest Neighbour Interpolation</p></div>
<p>Notice how the interpolated values are constant (flat) over this 
piecewise function. There are sharp discontinuities between each 
“piece”, and the above plot barely resembles a sinusoid. Now, I will 
repeat this interpolation on the decimated sinusoid, using linear 
interpolation.</p>
<div id="attachment_298" style="width: 351px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/3-sine-wave-linear.png"><img class="size-full wp-image-298 " title="3-sine-wave-linear" src="giassia-Dateien/3-sine-wave-linear.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/3-sine-wave-linear.png 568w, http://www.giassa.net/wp-content/uploads/2009/12/3-sine-wave-linear-300x265.png 300w" sizes="(max-width: 341px) 100vw, 341px" height="301" width="341"></a><p class="wp-caption-text">Reconstructed Sinusoid – Linear Interpolation</p></div>
<p>This is better than when we used nearest neighbour interpolation, as 
the above plot at least looks like a sinusoid to some extent. Also, each
 “piece” is linear, rather than constant, so it does a better job of 
approximating the original sinusoid. We still have one problem – each 
“piece” has a sharp discontinuity. We will correct this with cubic 
spline interpolation, as shown below:</p>
<div id="attachment_299" style="width: 351px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/4-sine-wave-spline.png"><img class="size-full wp-image-299 " title="4-sine-wave-spline" src="giassia-Dateien/4-sine-wave-spline.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/4-sine-wave-spline.png 568w, http://www.giassa.net/wp-content/uploads/2009/12/4-sine-wave-spline-300x265.png 300w" sizes="(max-width: 341px) 100vw, 341px" height="301" width="341"></a><p class="wp-caption-text">Reconstructed Sinusoid – Cubic Spline Interpolation</p></div>
<p>Note how the above plot closely resembles the original sinusoid quite
 well. More importantly, note how is does not have any sharp 
discontinuities as was the case with the two previous interpolation 
methods. Cubic spline interpolation is essentially another form of curve
 fitting, somewhat similar to linear interpolation. The difference is 
that instead of fitting all of the data points along a line, we fit them
 along a third order polynomial of the form:</p>
<ul>
<li><img src="giassia-Dateien/latex_043.png" alt="y=f(x)=a+bx+cx^2+dx^3" title="y=f(x)=a+bx+cx^2+dx^3" class="latex"></li>
</ul>
<p>What we need to remember is that we can’t simply have a single 
third-order polynomial equation that fits ALL of the data points in our 
original data set, it’s just not possible. What we can do, however, is 
to create a set of these equations for each “piece” of our interpolated 
data set so that they all connect together smoothly. We can define a 
cubic spline, according to [1], as follows:</p>
<p>For a set of <img src="giassia-Dateien/latex_018.png" alt="n+1" title="n+1" class="latex"> data points on <img src="giassia-Dateien/latex_036.png" alt="[j, k]" title="[j, k]" class="latex">, with a set of data points defined by <img src="giassia-Dateien/latex_042.png" alt="j=x_0, k=x_n" title="j=x_0, k=x_n" class="latex"> and <img src="giassia-Dateien/latex_061.png" alt="x_0 &lt; x_1 &lt; x_2 \ldots &lt; x_(n-1) &lt; x_n" title="x_0 &lt; x_1 &lt; x_2 \ldots &lt; x_(n-1) &lt; x_n" class="latex">, with y-values defined as <img src="giassia-Dateien/latex_014.png" alt="y_i = f(x_i)" title="y_i = f(x_i)" class="latex">, we can define a cubic spline interpolant <img src="giassia-Dateien/latex_040.png" alt="S" title="S" class="latex"> for the function <img src="giassia-Dateien/latex_044.png" alt="f(x)" title="f(x)" class="latex"> such that:</p>
<ol>
<li><img src="giassia-Dateien/latex_030.png" alt="S(x)" title="S(x)" class="latex"> is a cubic (third order) polynomial, denoted <img src="giassia-Dateien/latex_015.png" alt="S_i(x)" title="S_i(x)" class="latex">, on the subinterval <img src="giassia-Dateien/latex_056.png" alt="[x_i,x_{i+1}]" title="[x_i,x_{i+1}]" class="latex"> for each <img src="giassia-Dateien/latex_027.png" alt="i=0,1,\ldots , n-1" title="i=0,1,\ldots , n-1" class="latex"> (<em><strong>This is a function that provides a value for any point between the extreme data points <img src="giassia-Dateien/latex_023.png" alt="j" title="j" class="latex"> and <img src="giassia-Dateien/latex_052.png" alt="k" title="k" class="latex"></strong></em>.)</li>
<li><img src="giassia-Dateien/latex_016.png" alt="S_i(x_i) = f(x_i)" title="S_i(x_i) = f(x_i)" class="latex"> and <img src="giassia-Dateien/latex_005.png" alt="S_i(x_{i+1})=f(x_{i+1})" title="S_i(x_{i+1})=f(x_{i+1})" class="latex"> for each <img src="giassia-Dateien/latex_046.png" alt="i=0,1,\ldots ,n-1" title="i=0,1,\ldots ,n-1" class="latex"> (<em><strong>The spline MUST pass through each of the original data points, <img src="giassia-Dateien/latex_035.png" alt="f(x_i)" title="f(x_i)" class="latex"></strong></em>.)</li>
<li><img src="giassia-Dateien/latex_059.png" alt="S_{i+1}(x_{i+1}) = S_i(x_{i+1})" title="S_{i+1}(x_{i+1}) = S_i(x_{i+1})" class="latex"> for each <img src="giassia-Dateien/latex_055.png" alt="i=0,1,\ldots ,n-2" title="i=0,1,\ldots ,n-2" class="latex"> (<em><strong>We are creating a piecewise-continuous function over several sub-intervals of <img src="giassia-Dateien/latex_036.png" alt="[j, k]" title="[j, k]" class="latex">. This means that each “piece” of our interpolated data set must connect to its neighbouring “pieces”</strong></em>.)</li>
<li><img src="giassia-Dateien/latex_054.png" alt="S'_{i+1}(x_{i+1}) = S'_i(x_{i+1})" title="S'_{i+1}(x_{i+1}) = S'_i(x_{i+1})" class="latex"> for each <img src="giassia-Dateien/latex_055.png" alt="i=0,1,\ldots ,n-2" title="i=0,1,\ldots ,n-2" class="latex"> (<em><strong>At
 each data point, the first derivative (ie: the slope) must be the same 
on both sides, even if only on an infinitesimally small range. This 
makes sure that in addition to the function being continuous (from rules
 <img src="giassia-Dateien/latex_025.png" alt="(1), (2),(3)" title="(1), (2),(3)" class="latex"> above), that the spline is differentiable over the entire interval <img src="giassia-Dateien/latex_036.png" alt="[j, k]" title="[j, k]" class="latex"> as well. Without this contraint, we would still have the sharp discontinuities present in the previous interpolation methods.</strong></em>)</li>
<li><img src="giassia-Dateien/latex_003.png" alt="S''_{i+1}(x_{i+1}) = S''_i(x_{i+1})" title="S''_{i+1}(x_{i+1}) = S''_i(x_{i+1})" class="latex"> for each <img src="giassia-Dateien/latex_055.png" alt="i=0,1,\ldots ,n-2" title="i=0,1,\ldots ,n-2" class="latex"> (<em><strong>Similar to rule <img src="giassia-Dateien/latex.png" alt="(4)" title="(4)" class="latex"> above, this makes sure that the curvature (second derivative) is continuous as well.</strong></em>)</li>
<li>One of the two following sets of boundary conditions is satisfied:
<ol>
<li><img src="giassia-Dateien/latex_033.png" alt="S''(x_0)=S''(x_n)=0" title="S''(x_0)=S''(x_n)=0" class="latex"> (<em><strong>This
 is referred to as a “free/natural” boundary. Imagine a flexible, 
straight piece of string being pulled to pass through each and every 
data point.</strong></em>)</li>
<li><img src="giassia-Dateien/latex_007.png" alt="S'(x_0)=f'(x_0)" title="S'(x_0)=f'(x_0)" class="latex"> and <img src="giassia-Dateien/latex_060.png" alt="S'(x_n)=f'(x_n)" title="S'(x_n)=f'(x_n)" class="latex"> (<em><strong>This
 is referred to as a “clamped” boundary. It typically produces a spline 
that is more accurate than one generated using a “natural” boundary, but
 requires that we know the value of the derivatives at the end points. 
Since cubic spline interpolation does not yield the best results if we 
attempt to extrapolate data for the end points, and since we do not have
 this information on-hand, we will use “natural” boundaries in the rest 
of this tutorial</strong></em>.)</li>
</ol>
</li>
</ol>
<p>So, we now have a concrete definition of a spline. Now, how do we 
calculate one that fits our data points according to the criteria above?
 Without going into <strong>too</strong> much detail on the mathematics 
involved (a complete proof is available in [1]), for a natural cubic 
spline, we want, for each subinterval, <img src="giassia-Dateien/latex_058.png" alt="[x_{i-1},x_i]" title="[x_{i-1},x_i]" class="latex">, the coefficients for the following equation:</p>
<ul>
<li><img src="giassia-Dateien/latex_051.png" alt="S(x_i) = a_i+b_i (x-x_i) + c_i (x-x_i)^2+d_i (x-x_i)^3" title="S(x_i) = a_i+b_i (x-x_i) + c_i (x-x_i)^2+d_i (x-x_i)^3" class="latex"></li>
</ul>
<p>Applying the constraints previously listed to the above equation, we have the following set of equations:</p>
<ul>
<li><img src="giassia-Dateien/latex_032.png" alt="m_i = S(x_i)" title="m_i = S(x_i)" class="latex"></li>
<li><img src="giassia-Dateien/latex_034.png" alt="h_i = x_i-x_{i-1}" title="h_i = x_i-x_{i-1}" class="latex"></li>
<li><img src="giassia-Dateien/latex_037.png" alt="\alpha_i=2(h_i+h_{i+1})" title="\alpha_i=2(h_i+h_{i+1})" class="latex"> (note that this is the symbol for “alpha”, not a lowercase ‘a’; this criteria only applies to natural splines)</li>
<li><img src="giassia-Dateien/latex_053.png" alt="a_i = f(x_i)" title="a_i = f(x_i)" class="latex"></li>
<li><img src="giassia-Dateien/latex_006.png" alt="b_i = \dfrac{f(x_i)-f(x_{x-1})}{h_i} + \dfrac{h_i(2m_i+m_{i-1})}{6}" title="b_i = \dfrac{f(x_i)-f(x_{x-1})}{h_i} + \dfrac{h_i(2m_i+m_{i-1})}{6}" class="latex"></li>
<li><img src="giassia-Dateien/latex_028.png" alt="c_i = \dfrac{m_i}{2}" title="c_i = \dfrac{m_i}{2}" class="latex"></li>
<li><img src="giassia-Dateien/latex_013.png" alt="d_i = \dfrac{m_i-m_{i-1}}{6h_i}" title="d_i = \dfrac{m_i-m_{i-1}}{6h_i}" class="latex"></li>
</ul>
<p>Now, applying the criteria from rule (6.1), we get the following equation:</p>
<ul>
<li><img src="giassia-Dateien/latex_045.png" alt="h_{i-1}c_{i-1}+2(h_{i-1}+h_i)c_i+h_ic_{i+1} = \dfrac{3}{h_i}(a_{i+1}-a_i)-\dfrac{3}{h_i}(a_{i}-a_{i-1})" title="h_{i-1}c_{i-1}+2(h_{i-1}+h_i)c_i+h_ic_{i+1} = \dfrac{3}{h_i}(a_{i+1}-a_i)-\dfrac{3}{h_i}(a_{i}-a_{i-1})" class="latex"></li>
</ul>
<p>This equation provides with a set of equations we must now solve in the form of Ax=b, with the vectors/matrices defined as:</p>
<p><code><img src="giassia-Dateien/latex_049.png" alt="A= \left(\begin{array}{ccccccc}\alpha_1&amp;h_2&amp;0&amp;\cdots&amp;0&amp;0&amp;0\\h_2&amp;\alpha_2&amp;h_3&amp;\cdots&amp;0&amp;0&amp;0\\0&amp;h_3&amp;\alpha_4&amp;\cdots&amp;0&amp;0&amp;0\\\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots&amp;\vdots&amp;\vdots\\0&amp;0&amp;0&amp;\cdots&amp;\alpha_{n-3}&amp;h_{n-2}&amp;0\\0&amp;0&amp;0&amp;\cdots&amp;h_{n-2}&amp;\alpha_{n-1}&amp;h_{n-1}\\0&amp;0&amp;0&amp;\cdots&amp;0&amp;h_{n-1}&amp;\alpha_{n}\\\end{array}\right)" title="A= \left(\begin{array}{ccccccc}\alpha_1&amp;h_2&amp;0&amp;\cdots&amp;0&amp;0&amp;0\\h_2&amp;\alpha_2&amp;h_3&amp;\cdots&amp;0&amp;0&amp;0\\0&amp;h_3&amp;\alpha_4&amp;\cdots&amp;0&amp;0&amp;0\\\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots&amp;\vdots&amp;\vdots\\0&amp;0&amp;0&amp;\cdots&amp;\alpha_{n-3}&amp;h_{n-2}&amp;0\\0&amp;0&amp;0&amp;\cdots&amp;h_{n-2}&amp;\alpha_{n-1}&amp;h_{n-1}\\0&amp;0&amp;0&amp;\cdots&amp;0&amp;h_{n-1}&amp;\alpha_{n}\\\end{array}\right)" class="latex"></code></p>
<img src="giassia-Dateien/latex_047.png" alt="x= \left(\begin{array}{c}m_1\\m_2\\m_3\\\vdots\\m_{n-3}\\m_{n-2}\\m_{n-1}\end{array}\right)" title="x= \left(\begin{array}{c}m_1\\m_2\\m_3\\\vdots\\m_{n-3}\\m_{n-2}\\m_{n-1}\end{array}\right)" class="latex">
<img src="giassia-Dateien/latex_057.png" alt="b= 6\left(\begin{array}{c}\dfrac{f(x_2)-f(x_1)}{h_2}-\dfrac{f(x_1)-f(x_0)}{h_1}\\\dfrac{f(x_3)-f(x_2)}{h_3}-\dfrac{f(x_2)-f(x_1)}{h_2}\\\vdots\\\dfrac{f(x_{n-1})-f(x_{n-2})}{h_{n-1}}-\dfrac{f(x_{n-2})-f(x_{n-3})}{h_{n-2}}\\\dfrac{f(x_{n})-f(x_{n-1})}{h_{n}}-\dfrac{f(x_{n-1})-f(x_{n-2})}{h_{n-1}}\end{array}\right)" title="b= 6\left(\begin{array}{c}\dfrac{f(x_2)-f(x_1)}{h_2}-\dfrac{f(x_1)-f(x_0)}{h_1}\\\dfrac{f(x_3)-f(x_2)}{h_3}-\dfrac{f(x_2)-f(x_1)}{h_2}\\\vdots\\\dfrac{f(x_{n-1})-f(x_{n-2})}{h_{n-1}}-\dfrac{f(x_{n-2})-f(x_{n-3})}{h_{n-2}}\\\dfrac{f(x_{n})-f(x_{n-1})}{h_{n}}-\dfrac{f(x_{n-1})-f(x_{n-2})}{h_{n-1}}\end{array}\right)" class="latex">
<p>We already know the values for all <img src="giassia-Dateien/latex_020.png" alt="x_i" title="x_i" class="latex"> and <img src="giassia-Dateien/latex_035.png" alt="f(x_i)" title="f(x_i)" class="latex">, and from these, we can calculate the values for <img src="giassia-Dateien/latex_019.png" alt="a_i" title="a_i" class="latex">,<img src="giassia-Dateien/latex_041.png" alt="h_i" title="h_i" class="latex">, and <img src="giassia-Dateien/latex_002.png" alt="\alpha_i" title="\alpha_i" class="latex">. Once we’ve done this, we solve the matrix equation Ax=b for the x-vector containing the values <img src="giassia-Dateien/latex_012.png" alt="m_i" title="m_i" class="latex">. Once this is done, we can calculate the values <img src="giassia-Dateien/latex_062.png" alt="b_i" title="b_i" class="latex">,<img src="giassia-Dateien/latex_038.png" alt="c_i" title="c_i" class="latex">, and <img src="giassia-Dateien/latex_050.png" alt="d_i" title="d_i" class="latex">.
 Once all these values are calculated, we now have the coefficients for 
each “piece” of the entire cubic spline interpolating polynomial over <img src="giassia-Dateien/latex_036.png" alt="[j, k]" title="[j, k]" class="latex">.
 The sample MATLAB code below calculates a 1D cublic spline interpolant 
for an arbitrary 1D data set. As with all of my code, I will attempt to 
cover all the low-level details. This algorithm is based directly on the
 one provided in [1]. For a complete version of this algorithm written 
entirely in C, including code to solve a tridiagonal matrix, please 
refer to “ALGO34.C” at the web page for <a title="Numerical Analysis (8th) - Burden and Faires" href="http://www.as.ysu.edu/%7Efaires/Numerical-Analysis/DiskMaterial/programs/C/" target="_blank">Burden and Faires (8th)</a>.</p>
<p>The following MATLAB M-functions, csi.M, and csiplot.M below, can be 
tested by declaring a line space, x, and a function of x, y, and then 
running the csi and csiplot routines.</p>
<p><strong>Cubic Spline Interpolation Function:</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57d154e1cf7a4531559978" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><span class="crayon-language">MATLAB</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">%=========================================================================

function output_vector = csi( input_x,input_y )

%       CSI - calculates a cubic spline interpolant

%       input_vector - a 1-by-n vector of y-values

%       output_vector - a 1-by-n' vector of interpolated y-values

%=========================================================================

%Initialize variables

x=input_x;a=input_y;

n=length(a)-1;

b=zeros(1,n+1); c=zeros(1,n+1); d=zeros(1,n+1);

alpha=zeros(1,n+1);

l=zeros(1,n+1); mu=zeros(1,n+1); z=zeros(1,n+1); h=zeros(1,n);

%Step 1 - Set h-values

for i = 0:n-1

    j=i+1;

    h(j)=x(j+1)-x(j);

end

%Step 2 - Set alpha-values

for i = 1:n-1

    j=i+1;

    alpha(j)=3.*((a(j+1)-a(j))./h(j) - (a(j)-a(j-1))./h(j-1));

end

%=========================================================================

%Reduce tridiagonal matrix using method outlined in Burden and Faires (8th)

%=========================================================================

%Step 3 - Initialize indexes and specific values

i=0;

j=i+1;

l(j)=1;

mu(j)=0;

z(j)=0;

%Step 4 - Matrix reduction

for i = 1:n-1

    j=i+1;

    l(j)=2.*(x(j+1)-x(j-1))-h(j-1).*mu(j-1);

    mu(j)=h(j)./l(j);

    z(j)=(alpha(j)-h(j-1).*z(j-1))./l(j);

end

%Step 5 - Set remaining values

l(n+1)=1;

z(n+1)=0;

c(n+1)=0;

%Step 6 - Finish matrix reduction

for i = 0:n-1

    j=n-i;

    c(j)=z(j)-mu(j).*c(j+1);

    b(j)=(a(j+1)-a(j))./h(j)-h(j).*(c(j+1)+2.*c(j))./3;

    d(j)=(c(j+1)-c(j))./(3.*h(j));

end

%=========================================================================

%Finished with matrix calculations

%=========================================================================

output_vector = [a(1,1:length(a)-1);b(1,1:length(b)-1);c(1,1:length(c)-1);d(1,1:length(d)-1)];</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table style="" class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-2">2</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-4">4</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-6">6</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-8">8</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-10">10</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-12">12</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-14">14</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-16">16</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-18">18</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-20">20</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-22">22</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-24">24</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-26">26</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-28">28</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-30">30</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-32">32</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-34">34</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-36">36</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-38">38</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-40">40</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-42">42</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-44">44</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-46">46</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-48">48</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-50">50</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-52">52</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-54">54</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-56">56</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-58">58</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-60">60</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-62">62</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-64">64</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-66">66</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-68">68</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-70">70</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-72">72</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-74">74</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-76">76</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-78">78</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-80">80</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-82">82</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-84">84</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-86">86</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-88">88</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-90">90</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-92">92</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-94">94</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-96">96</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-98">98</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-100">100</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-102">102</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-104">104</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-106">106</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-108">108</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-110">110</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-112">112</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-114">114</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-116">116</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-118">118</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-120">120</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7a4531559978-122">122</div><div class="crayon-num" data-line="crayon-57d154e1cf7a4531559978-123">123</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-1"><span class="crayon-ta">%</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">=</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-2">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-4"><span class="crayon-st">function</span><span class="crayon-h"> </span><span class="crayon-i">output_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">csi</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">input_x</span><span class="crayon-sy">,</span><span class="crayon-i">input_y</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-6"><span class="crayon-ta">%</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">CSI</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">calculates</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-i">cubic</span><span class="crayon-h"> </span><span class="crayon-i">spline</span><span class="crayon-h"> </span><span class="crayon-i">interpolant</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-8">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-9"><span class="crayon-ta">%</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">input_vector</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">by</span><span class="crayon-o">-</span><span class="crayon-i">n</span><span class="crayon-h"> </span><span class="crayon-i">vector</span><span class="crayon-h"> </span><span class="crayon-i">of</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-o">-</span><span class="crayon-i">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-10">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-12"><span class="crayon-ta">%</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">output_vector</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">by</span><span class="crayon-o">-</span><span class="crayon-i">n</span>'<span class="crayon-h"> </span><span class="crayon-i">vector</span><span class="crayon-h"> </span><span class="crayon-i">of</span><span class="crayon-h"> </span><span class="crayon-i">interpolated</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-o">-</span><span class="crayon-i">values</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-14">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-15"><span class="crayon-ta">%</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">=</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-16">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-18"><span class="crayon-ta">%</span><span class="crayon-i">Initialize</span><span class="crayon-h"> </span><span class="crayon-i">variables</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-20">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-21"><span class="crayon-i">x</span><span class="crayon-o">=</span><span class="crayon-i">input_x</span><span class="crayon-sy">;</span><span class="crayon-i">a</span><span class="crayon-o">=</span><span class="crayon-i">input_y</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-22">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-23"><span class="crayon-i">n</span><span class="crayon-o">=</span><span class="crayon-r">length</span><span class="crayon-sy">(</span><span class="crayon-i">a</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-24">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-25"><span class="crayon-i">b</span><span class="crayon-o">=</span><span class="crayon-r">zeros</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-i">n</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-o">=</span><span class="crayon-r">zeros</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-i">n</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-o">=</span><span class="crayon-r">zeros</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-i">n</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-26">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-27"><span class="crayon-i">alpha</span><span class="crayon-o">=</span><span class="crayon-r">zeros</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-i">n</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-28">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-29"><span class="crayon-i">l</span><span class="crayon-o">=</span><span class="crayon-r">zeros</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-i">n</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">mu</span><span class="crayon-o">=</span><span class="crayon-r">zeros</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-i">n</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">z</span><span class="crayon-o">=</span><span class="crayon-r">zeros</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-i">n</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">h</span><span class="crayon-o">=</span><span class="crayon-r">zeros</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-i">n</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-30">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-31"><span class="crayon-ta">%</span><span class="crayon-i">Step</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">Set</span><span class="crayon-h"> </span><span class="crayon-v">h</span><span class="crayon-o">-</span><span class="crayon-i">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-32">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-34"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-r ">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-i">n</span><span class="crayon-o">-</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r ">j</span><span class="crayon-o">=</span><span class="crayon-r ">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">h</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-r">x</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">x</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-40"><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-41">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-42"><span class="crayon-ta">%</span><span class="crayon-i">Step</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">Set</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">-</span><span class="crayon-i">values</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-43">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-44">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-45"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-r ">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-i">n</span><span class="crayon-o">-</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-46">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r ">j</span><span class="crayon-o">=</span><span class="crayon-r ">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-48">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">alpha</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-cn">3.</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-r">a</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">a</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-r">h</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-r">a</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">a</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-r">h</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-50">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-51"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-52">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-53"><span class="crayon-ta">%</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">=</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-54">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-55">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-56"><span class="crayon-ta">%</span><span class="crayon-i">Reduce</span><span class="crayon-h"> </span><span class="crayon-i">tridiagonal</span><span class="crayon-h"> </span><span class="crayon-i">matrix</span><span class="crayon-h"> </span><span class="crayon-i">using</span><span class="crayon-h"> </span><span class="crayon-t">method</span><span class="crayon-h"> </span><span class="crayon-i">outlined</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-i">Burden</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-e">Faires</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">8th</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-57">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-58">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-59"><span class="crayon-ta">%</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">=</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-60">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-61">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-62"><span class="crayon-ta">%</span><span class="crayon-i">Step</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">Initialize</span><span class="crayon-h"> </span><span class="crayon-i">indexes</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-i">specific</span><span class="crayon-h"> </span><span class="crayon-i">values</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-63">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-64">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-65"><span class="crayon-r ">i</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-66">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-67"><span class="crayon-r ">j</span><span class="crayon-o">=</span><span class="crayon-r ">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-68">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-69"><span class="crayon-r">l</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-70">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-71"><span class="crayon-r">mu</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-72">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-73"><span class="crayon-r">z</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-74">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-75"><span class="crayon-ta">%</span><span class="crayon-i">Step</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">Matrix</span><span class="crayon-h"> </span><span class="crayon-i">reduction</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-76">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-77">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-78"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-r ">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-i">n</span><span class="crayon-o">-</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-79">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-80"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r ">j</span><span class="crayon-o">=</span><span class="crayon-r ">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-81">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-82"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">l</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-cn">2.</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-r">x</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">x</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">h</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">*</span><span class="crayon-r">mu</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-83">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-84"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">mu</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-r">h</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-r">l</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-85">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-86"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">z</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-r">alpha</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">h</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">*</span><span class="crayon-r">z</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-r">l</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-87">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-88"><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-89">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-90"><span class="crayon-ta">%</span><span class="crayon-i">Step</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">Set</span><span class="crayon-h"> </span><span class="crayon-i">remaining</span><span class="crayon-h"> </span><span class="crayon-i">values</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-91">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-92">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-93"><span class="crayon-r">l</span><span class="crayon-sy">(</span><span class="crayon-i">n</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-94">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-95"><span class="crayon-r">z</span><span class="crayon-sy">(</span><span class="crayon-i">n</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-96">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-97"><span class="crayon-r">c</span><span class="crayon-sy">(</span><span class="crayon-i">n</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-98">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-99"><span class="crayon-ta">%</span><span class="crayon-i">Step</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">Finish</span><span class="crayon-h"> </span><span class="crayon-i">matrix</span><span class="crayon-h"> </span><span class="crayon-i">reduction</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-100">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-101">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-102"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-r ">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-i">n</span><span class="crayon-o">-</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-103">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-104"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r ">j</span><span class="crayon-o">=</span><span class="crayon-i">n</span><span class="crayon-o">-</span><span class="crayon-r ">i</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-105">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-106"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">c</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-r">z</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">mu</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">*</span><span class="crayon-r">c</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-107">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-108"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">b</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-r">a</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">a</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-r">h</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">h</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-r">c</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">2.</span><span class="crayon-o">*</span><span class="crayon-r">c</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-cn">3</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-109">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-110"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">d</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-r">c</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">c</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-sy">(</span><span class="crayon-cn">3.</span><span class="crayon-o">*</span><span class="crayon-r">h</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-111">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-112"><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-113">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-114"><span class="crayon-ta">%</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">=</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-115">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-116">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-117"><span class="crayon-ta">%</span><span class="crayon-i">Finished</span><span class="crayon-h"> </span><span class="crayon-i">with</span><span class="crayon-h"> </span><span class="crayon-i">matrix</span><span class="crayon-h"> </span><span class="crayon-i">calculations</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-118">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-119">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-120"><span class="crayon-ta">%</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">=</span></div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-121">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7a4531559978-122">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7a4531559978-123"><span class="crayon-i">output_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-r">a</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-r">length</span><span class="crayon-sy">(</span><span class="crayon-i">a</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-r">b</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-r">length</span><span class="crayon-sy">(</span><span class="crayon-i">b</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-r">c</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-r">length</span><span class="crayon-sy">(</span><span class="crayon-i">c</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-r">d</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-r">length</span><span class="crayon-sy">(</span><span class="crayon-i">d</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0358 seconds] -->
<p>&nbsp;</p>
<p><strong>Plot(able) Vector Generation Code:</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57d154e1cf7bd057733623" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><span class="crayon-language">MATLAB</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">%=========================================================================
function
 output_matrix = csiplot( coef_matrix,x_matrix,y_matrix,n_insert )
%=========================================================================
%Initialize
 variables
a=coef_matrix(1,:);
b=coef_matrix(2,:);
c=coef_matrix(3,:);
d=coef_matrix(4,:);

%Determine size
[n1 n2]=size(x_matrix);
n_more_samples = n_insert;
new_total_n_samples = (n_more_samples+1).*(n2-1)+1;
output_x = zeros(1,new_total_n_samples);
output_y = 666.*ones(1,new_total_n_samples);

%Copy old x and y-values first
for i = 1:n2
    index = 1+(i-1).*(n_more_samples+1);
    output_x(index)=x_matrix(i);
    output_y(index)=y_matrix(i);
end

%Calculate new x-values
for i = 1:n2-1
    index = 1+(i-1).*(n_more_samples+1);

    start = x_matrix(i);
    stop = x_matrix(i+1);
    step = (x_matrix(i+1)-x_matrix(i))./(n_more_samples+1);
    %Space the x-values for the output evenly between input x-values
    for j = index+1:index+n_more_samples+1
        output_x(j)=output_x(j-1)+step;
    end
    %Calculate new (interpolated) y-values
    for j = index:index+n_more_samples+1
        
output_y(j)=d(i).*(output_x(j)-output_x(index))^3+c(i).*(output_x(j)-output_x(index))^2+b(i).*(output_x(j)-output_x(index))+a(i);

    end

end

output_matrix = [output_x;output_y];</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table style="" class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-2">2</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-4">4</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-6">6</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-8">8</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-10">10</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-12">12</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-14">14</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-16">16</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-18">18</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-20">20</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-22">22</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-24">24</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-26">26</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-28">28</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-30">30</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-32">32</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-34">34</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-36">36</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-38">38</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-40">40</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-42">42</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-44">44</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-46">46</div><div class="crayon-num" data-line="crayon-57d154e1cf7bd057733623-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7bd057733623-48">48</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-1"><span class="crayon-ta">%</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">=</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-2">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-3"><span class="crayon-st">function</span><span class="crayon-h"> </span><span class="crayon-i">output_matrix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">csiplot</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">coef_matrix</span><span class="crayon-sy">,</span><span class="crayon-i">x_matrix</span><span class="crayon-sy">,</span><span class="crayon-i">y_matrix</span><span class="crayon-sy">,</span><span class="crayon-i">n_insert</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-4"><span class="crayon-ta">%</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">=</span></div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-6"><span class="crayon-ta">%</span><span class="crayon-i">Initialize</span><span class="crayon-h"> </span><span class="crayon-i">variables</span></div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-8"><span class="crayon-i">a</span><span class="crayon-o">=</span><span class="crayon-r">coef_matrix</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-9"><span class="crayon-i">b</span><span class="crayon-o">=</span><span class="crayon-r">coef_matrix</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-10"><span class="crayon-i">c</span><span class="crayon-o">=</span><span class="crayon-r">coef_matrix</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-11"><span class="crayon-i">d</span><span class="crayon-o">=</span><span class="crayon-r">coef_matrix</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-12">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-13"><span class="crayon-ta">%</span><span class="crayon-i">Determine</span><span class="crayon-h"> </span><span class="crayon-i">size</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-14">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-15"><span class="crayon-sy">[</span><span class="crayon-e">n1 </span><span class="crayon-i">n2</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-r">size</span><span class="crayon-sy">(</span><span class="crayon-i">x_matrix</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-16"><span class="crayon-i">n_more_samples</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">n_insert</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-17"><span class="crayon-i">new_total_n_samples</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">n_more_samples</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-i">n2</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-18"><span class="crayon-i">output_x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">zeros</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-i">new_total_n_samples</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-19"><span class="crayon-i">output_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">666.</span><span class="crayon-o">*</span><span class="crayon-r">ones</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-i">new_total_n_samples</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-20">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-21"><span class="crayon-ta">%</span><span class="crayon-i">Copy</span><span class="crayon-h"> </span><span class="crayon-i">old</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-o">-</span><span class="crayon-i">values</span><span class="crayon-h"> </span><span class="crayon-i">first</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-22">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-23"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-r ">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-e">n2</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-24"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-r ">i</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-i">n_more_samples</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">output_x</span><span class="crayon-sy">(</span><span class="crayon-i">index</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-r">x_matrix</span><span class="crayon-sy">(</span><span class="crayon-r ">i</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">output_y</span><span class="crayon-sy">(</span><span class="crayon-i">index</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-r">y_matrix</span><span class="crayon-sy">(</span><span class="crayon-r ">i</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-27"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-28">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-29"><span class="crayon-ta">%</span><span class="crayon-i">Calculate</span><span class="crayon-h"> </span><span class="crayon-i">new</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">-</span><span class="crayon-i">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-30">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-31"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-r ">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-i">n2</span><span class="crayon-o">-</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-r ">i</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-i">n_more_samples</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">start</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">x_matrix</span><span class="crayon-sy">(</span><span class="crayon-r ">i</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">stop</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">x_matrix</span><span class="crayon-sy">(</span><span class="crayon-r ">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">step</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-r">x_matrix</span><span class="crayon-sy">(</span><span class="crayon-r ">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">x_matrix</span><span class="crayon-sy">(</span><span class="crayon-r ">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-sy">(</span><span class="crayon-i">n_more_samples</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">%Space the x-values for the output evenly between input x-values</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-r ">j</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">index</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-i">index</span><span class="crayon-o">+</span><span class="crayon-i">n_more_samples</span><span class="crayon-o">+</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">output_x</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-r">output_x</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-i">step</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">%Calculate new (interpolated) y-values</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-r ">j</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">index</span><span class="crayon-o">:</span><span class="crayon-i">index</span><span class="crayon-o">+</span><span class="crayon-i">n_more_samples</span><span class="crayon-o">+</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">output_y</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-r">d</span><span class="crayon-sy">(</span><span class="crayon-r ">i</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-r">output_x</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">output_x</span><span class="crayon-sy">(</span><span class="crayon-i">index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">3</span><span class="crayon-o">+</span><span class="crayon-r">c</span><span class="crayon-sy">(</span><span class="crayon-r ">i</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-r">output_x</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">output_x</span><span class="crayon-sy">(</span><span class="crayon-i">index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span><span class="crayon-o">+</span><span class="crayon-r">b</span><span class="crayon-sy">(</span><span class="crayon-r ">i</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-r">output_x</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">output_x</span><span class="crayon-sy">(</span><span class="crayon-i">index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-r">a</span><span class="crayon-sy">(</span><span class="crayon-r ">i</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-45">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-46"><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-57d154e1cf7bd057733623-47">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7bd057733623-48"><span class="crayon-i">output_matrix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">output_x</span><span class="crayon-sy">;</span><span class="crayon-i">output_y</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0162 seconds] -->
<p>&nbsp;</p>
<p><strong>Code for a Sample Run:</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57d154e1cf7c6626147836" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><span class="crayon-language">MATLAB</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">x1=1:1:20;

y1=sin(x1)+1;

xx=csi(x1,y1);

yy=csiplot(xx,x1,y1,10);
 %The 10 is the number of interpolated data points we want inserted 
between our existing datapoints. Increasing this number leads to a 
smoother curve.

 subplot(1,2,1);plot(x1,y1); subplot(1,2,2);plot(yy(1,:),yy(2,:));</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table style="" class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57d154e1cf7c6626147836-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7c6626147836-2">2</div><div class="crayon-num" data-line="crayon-57d154e1cf7c6626147836-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7c6626147836-4">4</div><div class="crayon-num" data-line="crayon-57d154e1cf7c6626147836-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7c6626147836-6">6</div><div class="crayon-num" data-line="crayon-57d154e1cf7c6626147836-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7c6626147836-8">8</div><div class="crayon-num" data-line="crayon-57d154e1cf7c6626147836-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57d154e1cf7c6626147836-1"><span class="crayon-i">x1</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-cn">20</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7c6626147836-2">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7c6626147836-3"><span class="crayon-i">y1</span><span class="crayon-o">=</span><span class="crayon-r">sin</span><span class="crayon-sy">(</span><span class="crayon-i">x1</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7c6626147836-4">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7c6626147836-5"><span class="crayon-i">xx</span><span class="crayon-o">=</span><span class="crayon-r">csi</span><span class="crayon-sy">(</span><span class="crayon-i">x1</span><span class="crayon-sy">,</span><span class="crayon-i">y1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7c6626147836-6">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7c6626147836-7"><span class="crayon-i">yy</span><span class="crayon-o">=</span><span class="crayon-r">csiplot</span><span class="crayon-sy">(</span><span class="crayon-i">xx</span><span class="crayon-sy">,</span><span class="crayon-i">x1</span><span class="crayon-sy">,</span><span class="crayon-i">y1</span><span class="crayon-sy">,</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">%The 10 is the number of interpolated data points we want inserted between our existing datapoints. Increasing this number leads to a smoother curve.</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7c6626147836-8">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7c6626147836-9"><span class="crayon-h"> </span><span class="crayon-r">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-r">plot</span><span class="crayon-sy">(</span><span class="crayon-i">x1</span><span class="crayon-sy">,</span><span class="crayon-i">y1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-r">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-r">plot</span><span class="crayon-sy">(</span><span class="crayon-r">yy</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-r">yy</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0033 seconds] -->
<p>&nbsp;</p>
<p>So, we now have a means to generate accurate interpolations for any 
arbitray data set which will allow for reasonably sharp edges while 
still maintaining a smooth and continuous transition between data 
points. This comes at the expense of a much more complicated algorithm. 
Hopefully, at the least you have learned the constraints required to 
understand how a cubic spline is continuous and smooth on the entire 
interval [j,k]. If you want to really understand the entire concept down
 to the finest detail, I highly recommend reading [1], section 3.4. Now,
 let’s extend this concept to image processing!</p>
<p>In order to carry out bicubic spline interpolation, we first need to 
define our coordinate systems as we did in the previous subsections, as 
shown below:</p>
<div id="attachment_408" style="width: 317px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/grid-nn1.png"><img class="size-full wp-image-408" title="grid-nn" src="giassia-Dateien/grid-nn1.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/grid-nn1.png 307w, http://www.giassa.net/wp-content/uploads/2009/12/grid-nn1-300x253.png 300w" sizes="(max-width: 307px) 100vw, 307px" height="259" width="307"></a><p class="wp-caption-text">Coordinate System</p></div>
<p>Here we calculate an interpolated data point based on a function of 
the nearest 4 neighbouring pixels from the source data. The twist here 
is that we need to generate a continuous, curved region from this data, 
rather than a linear one. To understand this better, consider a 
grayscale image: every point has an x-coordinate, y-coordinate, and an 
intensity value. The intensity value can be represented by a color, such
 as a grayscale value, which is proportional to the intensity value. 
Shown below is a 2D grayscale representation of a simple checkerboard 
(4×4 pixel) image upsampled using bicubic spline interpolation (we need 
at least a 3×3 pixel image to use bicubic spline interpolation).</p>
<div id="attachment_356" style="width: 310px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/2d-csi.png"><img class="size-medium wp-image-356" title="2d-csi" src="giassia-Dateien/2d-csi-300x212.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/2d-csi-300x212.png 300w, http://www.giassa.net/wp-content/uploads/2009/12/2d-csi.png 674w" sizes="(max-width: 300px) 100vw, 300px" height="212" width="300"></a><p class="wp-caption-text">2D Bicubic Resampling</p></div>
<p>This still doesn’t provide much insight into how bicubic 
interpolation generates a curved, interpolated surface. So, we’ll 
display these two images again, but instead of the intensity value 
representing a shade of gray, it will represent a height in 3D space, 
similar to a 3D elevation map.</p>
<div id="attachment_355" style="width: 310px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/3d-csi.png"><img class="size-medium wp-image-355" title="3d-csi" src="giassia-Dateien/3d-csi-300x208.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/3d-csi-300x208.png 300w, http://www.giassa.net/wp-content/uploads/2009/12/3d-csi-1024x711.png 1024w, http://www.giassa.net/wp-content/uploads/2009/12/3d-csi.png 1036w" sizes="(max-width: 300px) 100vw, 300px" height="208" width="300"></a><p class="wp-caption-text">3D Representation of Bicubic Resampling</p></div>
<p><em>So, we can see that we have taken the original data set, and 
interpolated values in both the x and y dimensions to create a smooth 
surface. <strong>An important note</strong>: Notice how the interpolated
 dataset is smooth in the x-direction, y-direction, and the xy-direction
 (ie: along the diagonals). This means that for any point in our 
interpolated data set, we should be able to compute not only the 
intensity (ie: height/grayscale) value, but also it’s derivative in ANY 
direction along x, y, or xy. This is equivalent to us having the 
following data available to us (</em><strong>assume <img src="giassia-Dateien/latex_011.png" alt="f(a,b)=" title="f(a,b)=" class="latex">the grayscale intensity value from the source image, <img src="giassia-Dateien/latex_017.png" alt="X" title="X" class="latex">, at <img src="giassia-Dateien/latex_048.png" alt="X(a,b)" title="X(a,b)" class="latex">, and that we are trying to calculate the interpolated grayscale value in the target/output image, <img src="giassia-Dateien/latex_039.png" alt="Y" title="Y" class="latex">, at <img src="giassia-Dateien/latex_021.png" alt="Y(J,K)" title="Y(J,K)" class="latex"></strong>):</p>
<ul>
<li>The original intensity values of the surrounding pixels (4 values)
<ul>
<li><img src="giassia-Dateien/latex_008.png" alt="f(A,B)" title="f(A,B)" class="latex"></li>
<li><img src="giassia-Dateien/latex_024.png" alt="f(A+1,B)" title="f(A+1,B)" class="latex"></li>
<li><img src="giassia-Dateien/latex_009.png" alt="f(A,B+1)" title="f(A,B+1)" class="latex"></li>
<li><img src="giassia-Dateien/latex_031.png" alt="f(A+1,B+1)" title="f(A+1,B+1)" class="latex"></li>
</ul>
</li>
<li>The partial derivatives along the x-axis for each of these points (4 values)
<ul>
<li><img src="giassia-Dateien/latex_010.png" alt="\dfrac{\delta f}{\delta x}=f_x" title="\dfrac{\delta f}{\delta x}=f_x" class="latex"></li>
</ul>
</li>
<li>The partial derivatives along the y-axis for each of these points (4 values)
<ul>
<li><img src="giassia-Dateien/latex_022.png" alt="\dfrac{\delta f}{\delta y}=f_y" title="\dfrac{\delta f}{\delta y}=f_y" class="latex"></li>
</ul>
</li>
<li>The cross-derivatives at each of these points (4 values)
<ul>
<li><img src="giassia-Dateien/latex_026.png" alt="\dfrac{\delta^2 f}{\delta y\delta x}=f_{xy}" title="\dfrac{\delta^2 f}{\delta y\delta x}=f_{xy}" class="latex"></li>
</ul>
</li>
</ul>
<p>This leaves us with a total of 16 values to solve for in the case of 
generalized bicubic interpolation, as opposed to the 4 needed with 1D 
cubic spline interpolation (<img src="giassia-Dateien/latex_004.png" alt="a_i,b_i,c_i," title="a_i,b_i,c_i," class="latex"> and <img src="giassia-Dateien/latex_050.png" alt="d_i" title="d_i" class="latex">).</p>
<p>In image processing, we usually do not have most of these values 
readily available, and must frequently approximate them though numerical
 methods. Fortunately, in the case of bicubic spline interpolation, 
there is a very easy way to approximate the solution to this problem 
using what we’ve already learned from the 1D case of cubic spline 
interpolation! (<em><strong>Note that “bicubic spline interpolation” is 
basically a special case of a more general technique referred to as 
“bicubic interpolation” Don’t confuse the two! Bicubic spline 
interpolation does not make use of the cross-derivative values, and 
therefore is not as accurate as generalized cubic interpolation, which 
will be covered in the <a title="IV – Generalized Bicubic Interpolation" href="http://www.giassa.net/?page_id=371" target="_self">next subsection</a></strong></em>.)</p>
<p>To generate our approximate solution, we simply do the following:</p>
<ol>
<li>Take our input (source) image, and caclulate the number of columns and rows</li>
<li>For each column (from top to bottom), calculate a linear 1D spline 
using the rows indexes as x-values and the intensity (grayscale) values 
as the y-values. Save these results to an ouput table.</li>
<li>Now, perform the same operation on all the rows (from left to right) of the previously generated output table.</li>
<li>Done!</li>
</ol>
<p>The following code uses the 1D cubic spline interpolation function to create the following upsampled images:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57d154e1cf7d6749511007" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div style="display: none;" class="crayon-button crayon-expand-button" title="Expand Code"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><span class="crayon-language">MATLAB</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">clear all;
new_size=10;
%src=[0 0 1 1; 0 0 1 1; 1 1 0.5 0.5];
src=rgb2gray(imread('trees_small.jpg','jpg'));
[a b] = size(src);
for c = 1:b
    x1 = 1:a;
    y1 = src(:,c)';
    xx=csi(x1,y1);
    temp=csiplot(xx,x1,y1,new_size);
    temp=temp(2,:);
    output(:,c)=temp;
end
[a b] = size(output);
for c = 1:a
    x1 = 1:b;
    y1 = output(c,:);
    xx=csi(x1,y1);
    temp=csiplot(xx,x1,y1,new_size);
    temp=temp(2,:);
    output2(c,:)=temp;
end
imagesc(output2);colormap gray;
%subplot(1,2,1);imagesc(output2);colormap gray;
%subplot(1,2,2);mesh(output2);
%subplot(1,2,1);imagesc(output2);colormap default;
%subplot(1,2,2);meshc(output2);shading interp;</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table style="" class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57d154e1cf7d6749511007-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7d6749511007-2">2</div><div class="crayon-num" data-line="crayon-57d154e1cf7d6749511007-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7d6749511007-4">4</div><div class="crayon-num" data-line="crayon-57d154e1cf7d6749511007-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7d6749511007-6">6</div><div class="crayon-num" data-line="crayon-57d154e1cf7d6749511007-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7d6749511007-8">8</div><div class="crayon-num" data-line="crayon-57d154e1cf7d6749511007-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7d6749511007-10">10</div><div class="crayon-num" data-line="crayon-57d154e1cf7d6749511007-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7d6749511007-12">12</div><div class="crayon-num" data-line="crayon-57d154e1cf7d6749511007-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7d6749511007-14">14</div><div class="crayon-num" data-line="crayon-57d154e1cf7d6749511007-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7d6749511007-16">16</div><div class="crayon-num" data-line="crayon-57d154e1cf7d6749511007-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7d6749511007-18">18</div><div class="crayon-num" data-line="crayon-57d154e1cf7d6749511007-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7d6749511007-20">20</div><div class="crayon-num" data-line="crayon-57d154e1cf7d6749511007-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7d6749511007-22">22</div><div class="crayon-num" data-line="crayon-57d154e1cf7d6749511007-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7d6749511007-24">24</div><div class="crayon-num" data-line="crayon-57d154e1cf7d6749511007-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7d6749511007-26">26</div><div class="crayon-num" data-line="crayon-57d154e1cf7d6749511007-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7d6749511007-28">28</div><div class="crayon-num" data-line="crayon-57d154e1cf7d6749511007-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154e1cf7d6749511007-30">30</div><div class="crayon-num" data-line="crayon-57d154e1cf7d6749511007-31">31</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57d154e1cf7d6749511007-1"><span class="crayon-r ">clear</span><span class="crayon-h"> </span><span class="crayon-st">all</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7d6749511007-2"><span class="crayon-i">new_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7d6749511007-3"><span class="crayon-ta">%</span><span class="crayon-v">src</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7d6749511007-4">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7d6749511007-5"><span class="crayon-i">src</span><span class="crayon-o">=</span><span class="crayon-r">rgb2gray</span><span class="crayon-sy">(</span><span class="crayon-r">imread</span><span class="crayon-sy">(</span><span class="crayon-s">'trees_small.jpg'</span><span class="crayon-sy">,</span><span class="crayon-s">'jpg'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7d6749511007-6"><span class="crayon-sy">[</span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-i">b</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">size</span><span class="crayon-sy">(</span><span class="crayon-i">src</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7d6749511007-7"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-i">b</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7d6749511007-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">x1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-i">a</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7d6749511007-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">y1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">src</span><span class="crayon-sy">(</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-i">c</span><span class="crayon-sy">)</span>'<span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7d6749511007-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">xx</span><span class="crayon-o">=</span><span class="crayon-r">csi</span><span class="crayon-sy">(</span><span class="crayon-i">x1</span><span class="crayon-sy">,</span><span class="crayon-i">y1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7d6749511007-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">temp</span><span class="crayon-o">=</span><span class="crayon-r">csiplot</span><span class="crayon-sy">(</span><span class="crayon-i">xx</span><span class="crayon-sy">,</span><span class="crayon-i">x1</span><span class="crayon-sy">,</span><span class="crayon-i">y1</span><span class="crayon-sy">,</span><span class="crayon-i">new_size</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7d6749511007-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">temp</span><span class="crayon-o">=</span><span class="crayon-r">temp</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7d6749511007-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">output</span><span class="crayon-sy">(</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-i">c</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-i">temp</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7d6749511007-14"><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-57d154e1cf7d6749511007-15"><span class="crayon-sy">[</span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-i">b</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">size</span><span class="crayon-sy">(</span><span class="crayon-i">output</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7d6749511007-16"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-i">a</span></div><div class="crayon-line" id="crayon-57d154e1cf7d6749511007-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">x1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-i">b</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7d6749511007-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">y1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">output</span><span class="crayon-sy">(</span><span class="crayon-i">c</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7d6749511007-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">xx</span><span class="crayon-o">=</span><span class="crayon-r">csi</span><span class="crayon-sy">(</span><span class="crayon-i">x1</span><span class="crayon-sy">,</span><span class="crayon-i">y1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7d6749511007-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">temp</span><span class="crayon-o">=</span><span class="crayon-r">csiplot</span><span class="crayon-sy">(</span><span class="crayon-i">xx</span><span class="crayon-sy">,</span><span class="crayon-i">x1</span><span class="crayon-sy">,</span><span class="crayon-i">y1</span><span class="crayon-sy">,</span><span class="crayon-i">new_size</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7d6749511007-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">temp</span><span class="crayon-o">=</span><span class="crayon-r">temp</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7d6749511007-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">output2</span><span class="crayon-sy">(</span><span class="crayon-i">c</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-i">temp</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7d6749511007-23"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7d6749511007-24"><span class="crayon-r">imagesc</span><span class="crayon-sy">(</span><span class="crayon-i">output2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-r ">colormap</span><span class="crayon-h"> </span><span class="crayon-r ">gray</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154e1cf7d6749511007-25"><span class="crayon-ta">%</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-e">imagesc</span><span class="crayon-sy">(</span><span class="crayon-v">output2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-i">colormap</span><span class="crayon-h"> </span><span class="crayon-v">gray</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7d6749511007-26">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7d6749511007-27"><span class="crayon-ta">%</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-e">mesh</span><span class="crayon-sy">(</span><span class="crayon-v">output2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7d6749511007-28">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7d6749511007-29"><span class="crayon-ta">%</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-e">imagesc</span><span class="crayon-sy">(</span><span class="crayon-v">output2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-i">colormap</span><span class="crayon-h"> </span><span class="crayon-v">default</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154e1cf7d6749511007-30">&nbsp;</div><div class="crayon-line" id="crayon-57d154e1cf7d6749511007-31"><span class="crayon-c">%subplot(1,2,2);meshc(output2);shading interp;</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0103 seconds] -->
<p>&nbsp;</p>
<div id="attachment_364" style="width: 310px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/gs-2d-3d.png"><img class="size-medium wp-image-364" title="gs-2d-3d" src="giassia-Dateien/gs-2d-3d-300x172.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/gs-2d-3d-300x172.png 300w, http://www.giassa.net/wp-content/uploads/2009/12/gs-2d-3d.png 793w" sizes="(max-width: 300px) 100vw, 300px" height="172" width="300"></a><p class="wp-caption-text">Grayscale – Checkered Pattern Upsampled with Bicubic Spline Interpolation</p></div>
<div id="attachment_362" style="width: 310px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/c-2d-3d.png"><img class="size-medium wp-image-362" title="c-2d-3d" src="giassia-Dateien/c-2d-3d-300x185.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/c-2d-3d-300x185.png 300w, http://www.giassa.net/wp-content/uploads/2009/12/c-2d-3d.png 764w" sizes="(max-width: 300px) 100vw, 300px" height="185" width="300"></a><p class="wp-caption-text">False Color – Checkered Pattern Upsampled with Bicubic Spline Interpolation</p></div>
<div id="attachment_363" style="width: 310px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/cool.png"><img class="size-medium wp-image-363" title="cool" src="giassia-Dateien/cool-300x196.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/cool-300x196.png 300w, http://www.giassa.net/wp-content/uploads/2009/12/cool.png 897w" sizes="(max-width: 300px) 100vw, 300px" height="196" width="300"></a><p class="wp-caption-text">False Color – Checkered Pattern Upsampled with Bicubic Spline Interpolation (Higher Resolution)</p></div>
<p>See how this interpolation method has resampled my “trees” picture from this:</p>
<p><a href="http://www.giassa.net/wp-content/uploads/2009/12/Copy-of-trees_small.jpg"><img class="aligncenter size-full wp-image-367" title="Copy of trees_small" src="giassia-Dateien/Copy-of-trees_small.jpg" alt="" height="75" width="100"></a></p>
<p>To this:</p>
<div id="attachment_365" style="width: 633px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/trees_up_bcsi.png"><img class="size-full wp-image-365" title="trees_up_bcsi" src="giassia-Dateien/trees_up_bcsi.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/trees_up_bcsi.png 623w, http://www.giassa.net/wp-content/uploads/2009/12/trees_up_bcsi-300x280.png 300w" sizes="(max-width: 623px) 100vw, 623px" height="583" width="623"></a><p class="wp-caption-text">Upsampled Trees using Bicubic Spline Interpolation</p></div>
<p>The image above looks better than when we used the two previous 
interpolation methods. Before we conclude this subsection, we should 
note a potential artifact that this interpolation method can introduce –
 halation. Just like how nearest neighbour interpolation introduces 
aliasing, or bilinear interpolation introduces blurring, this method 
introduces artifacts too. This essentially causes “halos” around parts 
of an image, or an overbrightening of select pixels near the borders of 
shapes. <strong>It can also cause values in the output image to be less 
than zero due to overshoot, so make sure to either normalize the final 
output image or adjust your code to check for this</strong>. More on this will be covered in the <a title="3 – Histograms &amp; Statistics " href="http://www.giassa.net/?page_id=411" target="_self">next section on histograms and statistics.</a></p>
<div id="attachment_369" style="width: 310px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/smile-halo.png"><img class="size-medium wp-image-369" title="smile-halo" src="giassia-Dateien/smile-halo-300x209.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/smile-halo-300x209.png 300w, http://www.giassa.net/wp-content/uploads/2009/12/smile-halo.png 656w" sizes="(max-width: 300px) 100vw, 300px" height="209" width="300"></a><p class="wp-caption-text">Halation</p></div>
<p>As shown above, notice how the image on the right has a bright “halo” around the outer edges of the smiley face.</p>
<p><strong>Please note</strong>: in the code I used to generate 1D cubic
 splines, you may notice that I designed the function to allow a 
user-selectable number of data points to be inserted between existing 
data points rather than to allow the user to specify the final number of
 data points in the result. With a little work, this should be easy to 
change. No point in making this <strong>too</strong> easy. Now, with 
bicubic spline interpolation covered, we will move on to the final 
subsection for resampling and interpolation: <a title="IV – Generalized Bicubic Interpolation" href="http://www.giassa.net/?page_id=371" target="_self">generalized bicubic interpolation</a>.</p>
<h1>References</h1>
<p>[1] Burden, Richard L., and J. Douglas Faires. <em>Numerical Analysis</em>. Belmont: Brooks Cole, 2004. Print.</p>
<p>[2] <em>Numerical recipes in C the art of scientific computing</em>. Cambridge: Cambridge UP, 1992. Print.</p>
<div id="_mcePaste" style="overflow: hidden; position: absolute; left: -10000px; top: 3698px; width: 1px; height: 1px;">(<strong>We are creating a piecewise-continuous function over several sub-intervals of <img src="giassia-Dateien/latex_029.png" alt="[j,k]" title="[j,k]" class="latex">. This means that each “piece” of our interpolated data set must connect to its neighbours</strong>)</div>
			</div><!-- .entry-content -->
	<footer class="entry-meta">
			</footer><!-- .entry-meta -->
</article><!-- #post-274 -->

						<div id="comments">
	
	
			<h2 id="comments-title">
			One thought on “<span>III – Bicubic Spline Interpolation</span>”		</h2>

		
		<ol class="commentlist">
				<li class="comment even thread-even depth-1" id="li-comment-39505">
		<article id="comment-39505" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt="" src="giassia-Dateien/cf0a8f6c33e9773c90f03583f43d533a.jpeg" srcset="http://0.gravatar.com/avatar/cf0a8f6c33e9773c90f03583f43d533a?s=136&amp;d=mm&amp;r=g 2x" class="avatar avatar-68 photo" height="68" width="68"><span class="fn">Ayic</span> on <a href="http://www.giassa.net/?page_id=274#comment-39505"><time datetime="2016-03-01T20:04:02+00:00">March 1, 2016 at 8:04 pm</time></a> <span class="says">said:</span>
									</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>I am grateful for your help!</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="http://www.giassa.net/?page_id=274&amp;replytocom=39505#respond" onclick='return addComment.moveForm( "comment-39505", "39505", "respond", "274" )' aria-label="Reply to Ayic">Reply <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
		</ol>

		
		
	
					<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://www.giassa.net/?page_id=274#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="http://www.giassa.net/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" size="30" maxlength="245" aria-required="true" required="required" type="text"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" size="30" maxlength="100" aria-describedby="email-notes" aria-required="true" required="required" type="text"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" size="30" maxlength="200" type="text"></p>
<p class="form-submit"><input name="submit" id="submit" class="submit" value="Post Comment" type="submit"> <input name="comment_post_ID" value="274" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="16384db594" type="hidden"></p><p style="display: none;"></p>				<input id="ak_js" name="ak_js" value="1473336547604" type="hidden"></form>
					</div><!-- #respond -->
		
</div><!-- #comments -->

				
			</div><!-- #content -->
		</div><!-- #primary -->


	</div><!-- #main -->

	<footer id="colophon" role="contentinfo">

			

			<div id="site-generator">
								<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform">Proudly powered by WordPress</a>
			</div>
	</footer><!-- #colophon -->
</div><!-- #page -->

<script type="text/javascript" src="giassia-Dateien/form.js"></script>
<script type="text/javascript" src="giassia-Dateien/comment-reply.js"></script>
<script type="text/javascript" src="giassia-Dateien/wp-embed.js"></script>


</body></html>