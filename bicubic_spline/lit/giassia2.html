<!DOCTYPE html>
<!--[if IE 6]>
<html id="ie6" lang="en-US">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 6) & !(IE 7) & !(IE 8)]><!-->
<html lang="en-US"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">


<title>Image Processing - Generalized Bicubic Interpolation | GIASSA.NET</title>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="stylesheet" type="text/css" media="all" href="giassia2-Dateien/style.css">
<link rel="pingback" href="http://www.giassa.net/xmlrpc.php">
<!--[if lt IE 9]>
<script src="http://www.giassa.net/wp-content/themes/twentyeleven/js/html5.js" type="text/javascript"></script>
<![endif]-->

<!-- All in One SEO Pack 2.3.8 by Michael Torbert of Semper Fi Web Design[355,419] -->
<meta name="description" content="A tutorial on the general concept of bicubic interpolation.">

<meta name="keywords" content="image processing,matlab,cubic,bicubic,spline,interpolation,generalized,mri,giassa,matthew,sfu,engineering">

<link rel="canonical" href="http://www.giassa.net/?page_id=371">
<!-- /all in one seo pack -->
<link rel="alternate" type="application/rss+xml" title="GIASSA.NET » Feed" href="http://www.giassa.net/?feed=rss2">
<link rel="alternate" type="application/rss+xml" title="GIASSA.NET » Comments Feed" href="http://www.giassa.net/?feed=comments-rss2">
<link rel="alternate" type="application/rss+xml" title="GIASSA.NET » IV – Generalized Bicubic Interpolation Comments Feed" href="http://www.giassa.net/?feed=rss2&amp;page_id=371">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/www.giassa.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.5.4"}};
			!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;if(!g||!g.fillText)return!1;switch(g.textBaseline="top",g.font="600 32px Arial",a){case"flag":return g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3;case"diversity":return g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,d=c[0]+","+c[1]+","+c[2]+","+c[3],g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e;case"simple":return g.fillText(h(55357,56835),0,0),0!==g.getImageData(16,16,1,1).data[0];case"unicode8":return g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script type="text/javascript" src="giassia2-Dateien/wp-emoji-release.js"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="crayon-css" href="giassia2-Dateien/crayon.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-son-of-obsidian-css" href="giassia2-Dateien/son-of-obsidian.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="giassia2-Dateien/monaco.css" type="text/css" media="all">
<script type="text/javascript" src="giassia2-Dateien/jquery_002.js"></script>
<script type="text/javascript" src="giassia2-Dateien/jquery-migrate.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/www.giassa.net\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="giassia2-Dateien/crayon.js"></script>
<script type="text/javascript" src="giassia2-Dateien/jquery.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var IZ = {"with_woocommerce":"0","woo_categories":"0","lazy_load":"0","options":[]};
/* ]]> */
</script>
<script type="text/javascript" src="giassia2-Dateien/image_zoom-init.js"></script>
<link rel="https://api.w.org/" href="http://www.giassa.net/?rest_route=/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.giassa.net/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.giassa.net/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 4.5.4">
<link rel="shortlink" href="http://www.giassa.net/?p=371">
<link rel="alternate" type="application/json+oembed" href="http://www.giassa.net/?rest_route=%2Foembed%2F1.0%2Fembed&amp;url=http%3A%2F%2Fwww.giassa.net%2F%3Fpage_id%3D371">
<link rel="alternate" type="text/xml+oembed" href="http://www.giassa.net/?rest_route=%2Foembed%2F1.0%2Fembed&amp;url=http%3A%2F%2Fwww.giassa.net%2F%3Fpage_id%3D371&amp;format=xml">
<style type="text/css">
/* <![CDATA[ */
img.latex { vertical-align: middle; border: none; }
/* ]]> */
</style>
</head>

<body class="page page-id-371 page-child parent-pageid-200 page-template-default single-author singular two-column right-sidebar">
<div id="page" class="hfeed">
	<header id="branding" role="banner">
			<hgroup>
				<h1 id="site-title"><span><a href="http://www.giassa.net/" rel="home">GIASSA.NET</a></span></h1>
				<h2 id="site-description">Engineering, DIY, and Everything Else</h2>
			</hgroup>

						<a href="http://www.giassa.net/">
									<img src="giassia2-Dateien/image_banner_scaled.png" alt="GIASSA.NET" height="288" width="1000">
							</a>
			
								<form method="get" id="searchform" action="http://www.giassa.net/">
		<label for="s" class="assistive-text">Search</label>
		<input class="field" name="s" id="s" placeholder="Search" type="text">
		<input class="submit" name="submit" id="searchsubmit" value="Search" type="submit">
	</form>
			
			<nav id="access" role="navigation">
				<h3 class="assistive-text">Main menu</h3>
								<div class="skip-link"><a class="assistive-text" href="#content">Skip to primary content</a></div>
												<div class="menu"><ul><li><a href="http://www.giassa.net/">Home</a></li><li class="page_item page-item-865 page_item_has_children current_page_ancestor"><a href="http://www.giassa.net/?page_id=865">Projects</a><ul class="children"><li class="page_item page-item-1075 page_item_has_children"><a href="http://www.giassa.net/?page_id=1075">Algorithms</a><ul class="children"><li class="page_item page-item-1080"><a href="http://www.giassa.net/?page_id=1080">Base64 Encoder</a></li><li class="page_item page-item-1215"><a href="http://www.giassa.net/?page_id=1215">Finding “holes” in a sorted list of numbers</a></li><li class="page_item page-item-1203"><a href="http://www.giassa.net/?page_id=1203">Largest Sub-Square in a Binary Array</a></li><li class="page_item page-item-1120"><a href="http://www.giassa.net/?page_id=1120">Linked Lists</a></li><li class="page_item page-item-1031"><a href="http://www.giassa.net/?page_id=1031">Maze Generation &amp; Solving</a></li><li class="page_item page-item-1116"><a href="http://www.giassa.net/?page_id=1116">Stacks</a></li></ul></li><li class="page_item page-item-1274"><a href="http://www.giassa.net/?page_id=1274">Blacksmithing</a></li><li class="page_item page-item-880 page_item_has_children"><a href="http://www.giassa.net/?page_id=880">Bowyery</a><ul class="children"><li class="page_item page-item-1127"><a href="http://www.giassa.net/?page_id=1127">Bumblebee</a></li><li class="page_item page-item-1125"><a href="http://www.giassa.net/?page_id=1125">Heavy Longbow</a></li><li class="page_item page-item-1123"><a href="http://www.giassa.net/?page_id=1123">Heavy Pyramid Bow</a></li></ul></li><li class="page_item page-item-1078 page_item_has_children"><a href="http://www.giassa.net/?page_id=1078">Challenges &amp; Competitions</a><ul class="children"><li class="page_item page-item-867"><a href="http://www.giassa.net/?page_id=867">Eudyptula Challenge</a></li><li class="page_item page-item-869"><a href="http://www.giassa.net/?page_id=869">Matasanto Crypto Challenge</a></li></ul></li><li class="page_item page-item-878 page_item_has_children"><a href="http://www.giassa.net/?page_id=878">Homebrewing</a><ul class="children"><li class="page_item page-item-1163"><a href="http://www.giassa.net/?page_id=1163">Beer</a></li><li class="page_item page-item-1190"><a href="http://www.giassa.net/?page_id=1190">Mead</a></li></ul></li><li class="page_item page-item-118 page_item_has_children current_page_ancestor"><a href="http://www.giassa.net/?page_id=118">Image Processing Tutorials</a><ul class="children"><li class="page_item page-item-169"><a href="http://www.giassa.net/?page_id=169">0 – The Basics</a></li><li class="page_item page-item-174"><a href="http://www.giassa.net/?page_id=174">1 – Downsampling</a></li><li class="page_item page-item-200 page_item_has_children current_page_ancestor current_page_parent"><a href="http://www.giassa.net/?page_id=200">2 – Upsampling &amp; Interpolation</a><ul class="children"><li class="page_item page-item-207"><a href="http://www.giassa.net/?page_id=207">I – Nearest Neighbour Interpolation</a></li><li class="page_item page-item-240"><a href="http://www.giassa.net/?page_id=240">II – Bilinear Interpolation</a></li><li class="page_item page-item-274"><a href="http://www.giassa.net/?page_id=274">III – Bicubic Spline Interpolation</a></li><li class="page_item page-item-371 current_page_item"><a href="http://www.giassa.net/?page_id=371">IV – Generalized Bicubic Interpolation</a></li></ul></li><li class="page_item page-item-411 page_item_has_children"><a href="http://www.giassa.net/?page_id=411">3 – Histograms, Statistics, &amp; Single Pixel Operations</a><ul class="children"><li class="page_item page-item-470"><a href="http://www.giassa.net/?page_id=470">I – Histograms &amp; Statistics</a></li><li class="page_item page-item-472"><a href="http://www.giassa.net/?page_id=472">II – Contrast Adjustment &amp; Image Normalization</a></li><li class="page_item page-item-475"><a href="http://www.giassa.net/?page_id=475">III – Gamma Correction</a></li><li class="page_item page-item-477"><a href="http://www.giassa.net/?page_id=477">IV – Logarithmic Transformation</a></li><li class="page_item page-item-479"><a href="http://www.giassa.net/?page_id=479">V – Error Vectors</a></li></ul></li><li class="page_item page-item-584 page_item_has_children"><a href="http://www.giassa.net/?page_id=584">4 – Spatial Convolution Masks</a><ul class="children"><li class="page_item page-item-588"><a href="http://www.giassa.net/?page_id=588">I – Basic Masks</a></li><li class="page_item page-item-590"><a href="http://www.giassa.net/?page_id=590">II – Special Masks and Edge Detection</a></li></ul></li><li class="page_item page-item-237 page_item_has_children"><a href="http://www.giassa.net/?page_id=237">5 – Image Noise &amp; Spatial Domain Filtering</a><ul class="children"><li class="page_item page-item-635"><a href="http://www.giassa.net/?page_id=635">I – Salt &amp; Pepper Noise – Non-Linear Filtering</a></li><li class="page_item page-item-637"><a href="http://www.giassa.net/?page_id=637">II – Gaussian Noise – Linear Filtering</a></li><li class="page_item page-item-639"><a href="http://www.giassa.net/?page_id=639">III – Adaptive Filtering</a></li></ul></li></ul></li><li class="page_item page-item-1083 page_item_has_children"><a href="http://www.giassa.net/?page_id=1083">Software Projects</a><ul class="children"><li class="page_item page-item-1144"><a href="http://www.giassa.net/?page_id=1144">Brain Venctricle Analyzer</a></li><li class="page_item page-item-553"><a href="http://www.giassa.net/?page_id=553">ThunderVoice</a></li></ul></li><li class="page_item page-item-1129 page_item_has_children"><a href="http://www.giassa.net/?page_id=1129">Systems</a><ul class="children"><li class="page_item page-item-1154"><a href="http://www.giassa.net/?page_id=1154">AcousticAid</a></li><li class="page_item page-item-1131"><a href="http://www.giassa.net/?page_id=1131">Breast Cancer Screening Device</a></li><li class="page_item page-item-1158"><a href="http://www.giassa.net/?page_id=1158">SolarMax Wireless Charge Controller</a></li></ul></li><li class="page_item page-item-1219 page_item_has_children"><a href="http://www.giassa.net/?page_id=1219">Woodworking</a><ul class="children"><li class="page_item page-item-1221"><a href="http://www.giassa.net/?page_id=1221">“Thomas the Tank Engine” styled wagon</a></li><li class="page_item page-item-1277"><a href="http://www.giassa.net/?page_id=1277">Ana White “Tryde” Coffee Table</a></li><li class="page_item page-item-1265"><a href="http://www.giassa.net/?page_id=1265">Heavy duty workbench</a></li></ul></li></ul></li><li class="page_item page-item-17"><a href="http://www.giassa.net/?page_id=17">News</a></li><li class="page_item page-item-3"><a href="http://www.giassa.net/?page_id=3">Papers &amp; Publications</a></li><li class="page_item page-item-163"><a href="http://www.giassa.net/?page_id=163">DISCLAIMER</a></li></ul></div>
			</nav><!-- #access -->
	</header><!-- #branding -->


	<div id="main">

		<div id="primary">
			<div id="content" role="main">

				
					
<article id="post-371" class="post-371 page type-page status-publish hentry">
	<header class="entry-header">
		<h1 class="entry-title">IV – Generalized Bicubic Interpolation</h1>
	</header><!-- .entry-header -->

	<div class="entry-content">
		<p>If you haven’t read the previous section on bicubic spline interpolation, now would be a good time!</p>
<p>As mentioned in the previous section, when we are performing bicubic 
interpolation, we are generating a smooth surface that interpolates data
 points on a 2D grid. Also, as previously mentioned…</p>
<h1>Quote:</h1>
<p><em>So, we can see that we have taken the original data set, and 
interpolated values in both the x and y dimensions to create a smooth 
surface. <strong>An important note</strong>: Notice how the interpolated
 dataset is smooth in the x-direction, y-direction, and the xy-direction
 (ie: along the diagonals). This means that for any point in our 
interpolated data set, we should be able to compute not only the 
intensity (ie: height/grayscale) value, but also it’s derivative in ANY 
direction along x, y, or xy. This is equivalent to us having the 
following data available to us (assume <img src="giassia2-Dateien/latex_011.png" alt="f(a,b)=" title="f(a,b)=" class="latex">the grayscale intensity value from the source image, <img src="giassia2-Dateien/latex_017.png" alt="X" title="X" class="latex">, at <img src="giassia2-Dateien/latex_044.png" alt="X(a,b)" title="X(a,b)" class="latex">, and that we are trying to calculate the interpolated grayscale value in the target/output image, <img src="giassia2-Dateien/latex_035.png" alt="Y" title="Y" class="latex">, at <img src="giassia2-Dateien/latex_027.png" alt="Y(J,K)" title="Y(J,K)" class="latex">) (Equations based on those provided in [1]):</em></p>
<ul>
<li><em>The original intensity values of the surrounding pixels (4 values) </em>
<ul>
<li><em><img src="giassia2-Dateien/latex_008.png" alt="f(A,B)" title="f(A,B)" class="latex"></em></li>
<li><em><img src="giassia2-Dateien/latex_022.png" alt="f(A+1,B)" title="f(A+1,B)" class="latex"></em></li>
<li><em><img src="giassia2-Dateien/latex_023.png" alt="f(A,B+1)" title="f(A,B+1)" class="latex"></em></li>
<li><em><img src="giassia2-Dateien/latex_030.png" alt="f(A+1,B+1)" title="f(A+1,B+1)" class="latex"></em></li>
</ul>
</li>
<li><em>The partial derivatives along the x-axis for each of these points (4 values) </em>
<ul>
<li><em><img src="giassia2-Dateien/latex_009.png" alt="\dfrac{\delta f}{\delta x}=f_x" title="\dfrac{\delta f}{\delta x}=f_x" class="latex"></em></li>
</ul>
</li>
<li><em>The partial derivatives along the y-axis for each of these points (4 values) </em>
<ul>
<li><em><img src="giassia2-Dateien/latex_054.png" alt="\dfrac{\delta f}{\delta y}=f_y" title="\dfrac{\delta f}{\delta y}=f_y" class="latex"></em></li>
</ul>
</li>
<li><em>The cross-derivatives at each of these points (4 values) </em>
<ul>
<li><em><img src="giassia2-Dateien/latex_006.png" alt="\dfrac{\delta^2 f}{\delta y\delta x}=f_{xy}" title="\dfrac{\delta^2 f}{\delta y\delta x}=f_{xy}" class="latex"></em></li>
</ul>
</li>
</ul>
<p><em> This leaves us with a total of 16 values to solve for in the 
case of generalized bicubic interpolation, as opposed to the 4 needed 
with 1D cubic spline interpolation (<img src="giassia2-Dateien/latex_057.png" alt="a_i,b_i,c_i," title="a_i,b_i,c_i," class="latex"> and <img src="giassia2-Dateien/latex_018.png" alt="d_i" title="d_i" class="latex">).</em></p>
<h1>End Quote</h1>
<p>I also mentioned in the previous section that bicubic spline 
interpolation is a special case of generalized bicubic interpolation. 
For the former of the two, we simply carried out 1D cubic spline 
interpolation along each axis and we were done. We aren’t making use of 
all the data available to us though, such as the cross-derivatives.</p>
<p>For each of the neighbouring 4 data points, we need to know its intensity value (<img src="giassia2-Dateien/latex_033.png" alt="X(A,B)" title="X(A,B)" class="latex">), its partial derivatives along both axes (<img src="giassia2-Dateien/latex_009.png" alt="\dfrac{\delta f}{\delta x}=f_x" title="\dfrac{\delta f}{\delta x}=f_x" class="latex"> and <img src="giassia2-Dateien/latex_054.png" alt="\dfrac{\delta f}{\delta y}=f_y" title="\dfrac{\delta f}{\delta y}=f_y" class="latex">), and finally, its cross-derivatives (<img src="giassia2-Dateien/latex_006.png" alt="\dfrac{\delta^2 f}{\delta y\delta x}=f_{xy}" title="\dfrac{\delta^2 f}{\delta y\delta x}=f_{xy}" class="latex">)
 before we can proceed any further. Before we proceed these, we need a 
coordinate system, as always. Notice how we now need to know the values 
of (1-h),(1-w), etc, whereas when we carried out bicubic spline 
interpolation we didn’t!</p>
<div id="attachment_423" style="width: 317px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/grid-others1.png"><img class="size-full wp-image-423" title="grid-others" src="giassia2-Dateien/grid-others1.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/grid-others1.png 307w, http://www.giassa.net/wp-content/uploads/2009/12/grid-others1-300x253.png 300w" sizes="(max-width: 307px) 100vw, 307px" height="259" width="307"></a><p class="wp-caption-text">Grid Coordinates</p></div>
<p>We can calculate the partial derivatives easily enough using centered
 differences, which are basically slope calculations using the intensity
 values, <img src="giassia2-Dateien/latex_003.png" alt="f(a,b)" title="f(a,b)" class="latex"> from adjacent pixels. For the partial derivative along the horizontal axis<em>, </em><img src="giassia2-Dateien/latex_009.png" alt="\dfrac{\delta f}{\delta x}=f_x" title="\dfrac{\delta f}{\delta x}=f_x" class="latex">, we can calculate it to be (assuming equal spacing between pixels in the source image):</p>
<ul>
<li><img src="giassia2-Dateien/latex_053.png" alt="f_x(A,B)=\dfrac{f(A+1,B)-f(A-1,B)}{(A+1)-(A-1)}=\dfrac{f(A+1,B)-f(A-1,B)}{2}" title="f_x(A,B)=\dfrac{f(A+1,B)-f(A-1,B)}{(A+1)-(A-1)}=\dfrac{f(A+1,B)-f(A-1,B)}{2}" class="latex"></li>
</ul>
<p>Similarly, we calculate the partial derivative for the vertical axis at each neighbouring pixel by:</p>
<ul>
<li><img src="giassia2-Dateien/latex_043.png" alt="f_y(A,B)=\dfrac{f(A,B+1)-f(A,B-1)}{(B+1)-(B-1)}=\dfrac{f(A,B+1)-f(A,B-1)}{2}" title="f_y(A,B)=\dfrac{f(A,B+1)-f(A,B-1)}{(B+1)-(B-1)}=\dfrac{f(A,B+1)-f(A,B-1)}{2}" class="latex"></li>
</ul>
<p>Finally, for the cross derivatives, we can calculate them by:</p>
<ul>
<li><img src="giassia2-Dateien/latex_026.png" alt="f_{xy}(A,B)=\dfrac{[f(A-1,B-1)+f(A+1,B+1)]-[f(A+1,B-1)+f(A-1,B+1)]}{[(A+1)-(A-1)]*[(B+1)-(B-1)]}" title="f_{xy}(A,B)=\dfrac{[f(A-1,B-1)+f(A+1,B+1)]-[f(A+1,B-1)+f(A-1,B+1)]}{[(A+1)-(A-1)]*[(B+1)-(B-1)]}" class="latex"></li>
<li>Therefore, <img src="giassia2-Dateien/latex_049.png" alt="f_{xy}(A,B)=\dfrac{[f(A-1,B-1)+f(A+1,B+1)]-[f(A+1,B-1)+f(A-1,B+1)]}{4}" title="f_{xy}(A,B)=\dfrac{[f(A-1,B-1)+f(A+1,B+1)]-[f(A+1,B-1)+f(A-1,B+1)]}{4}" class="latex"></li>
</ul>
<p><strong>If the spacing between pixels is not equal (ie: you are only 
carrying out interpolation on part of an image rather than the whole 
thing), you will need to adjust the denominator values in the above 
equations. Note that even if you get these values wrong, </strong><strong>the final result will still be smooth, just not as accurate!</strong></p>
<p>With these values available, we can defined any interpolated value in our output/target image, <img src="giassia2-Dateien/latex_021.png" alt="p(x,y)" title="p(x,y)" class="latex">,
 as a function of the pixels from our input image according to (refer to
 the grid coordinates in the figure above for visual definitions of 
A,B,J,K,h, and w):</p>
<ul>
<li><img src="giassia2-Dateien/latex_038.png" alt="p(J,K)=\sum_{m=0}^{3}\sum_{n=0}^{3}a_{mn}(1-w)^m(1-h)^n" title="p(J,K)=\sum_{m=0}^{3}\sum_{n=0}^{3}a_{mn}(1-w)^m(1-h)^n" class="latex"></li>
<li><img src="giassia2-Dateien/latex_051.png" alt="p_x(J,K)=\sum_{m=0}^{3}\sum_{n=0}^{3}a_{mn}(1-w)^{m-1}(1-h)^n" title="p_x(J,K)=\sum_{m=0}^{3}\sum_{n=0}^{3}a_{mn}(1-w)^{m-1}(1-h)^n" class="latex"></li>
<li><img src="giassia2-Dateien/latex_036.png" alt="p_y(J,K)=\sum_{m=0}^{3}\sum_{n=0}^{3}a_{mn}(1-w)^m(1-h)^{n-1}" title="p_y(J,K)=\sum_{m=0}^{3}\sum_{n=0}^{3}a_{mn}(1-w)^m(1-h)^{n-1}" class="latex"></li>
<li><img src="giassia2-Dateien/latex_010.png" alt="p_{xy}(J,K)=\sum_{m=0}^{3}\sum_{n=0}^{3}a_{mn}(1-w)^{m-1}(1-h)^{n-1}" title="p_{xy}(J,K)=\sum_{m=0}^{3}\sum_{n=0}^{3}a_{mn}(1-w)^{m-1}(1-h)^{n-1}" class="latex"></li>
</ul>
<p>However, before we can carry on, we need to solve for the coefficients, <img src="giassia2-Dateien/latex_020.png" alt="a_{ij}" title="a_{ij}" class="latex">. Assuming that <img src="giassia2-Dateien/latex_007.png" alt="w" title="w" class="latex"> and <img src="giassia2-Dateien/latex_046.png" alt="h" title="h" class="latex"> are continuous over the interval <img src="giassia2-Dateien/latex_031.png" alt="[0,1]" title="[0,1]" class="latex">, and that we redefine the values at the gridpoints of the source image, <img src="giassia2-Dateien/latex_039.png" alt="f(A,B),f(A+1,B),f(A,B+1),f(A+1,B+1)" title="f(A,B),f(A+1,B),f(A,B+1),f(A+1,B+1)" class="latex"> as <img src="giassia2-Dateien/latex_028.png" alt="f(0,0),f(1,0),f(0,1),f(1,1)" title="f(0,0),f(1,0),f(0,1),f(1,1)" class="latex">, we can express all 16 coefficients of <img src="giassia2-Dateien/latex.png" alt="a_{mn}" title="a_{mn}" class="latex"> as follows (equations provided by [1]):</p>
<ul>
<li>Function values:
<ul>
<li><img src="giassia2-Dateien/latex_037.png" alt="f(0,0)=a_{00}" title="f(0,0)=a_{00}" class="latex"></li>
<li><img src="giassia2-Dateien/latex_005.png" alt="f(1,0)=a_{00}+a_{10}+a_{20}+a_{30}" title="f(1,0)=a_{00}+a_{10}+a_{20}+a_{30}" class="latex"></li>
<li><img src="giassia2-Dateien/latex_047.png" alt="f(0,1)=a_{00}+a_{01}+a_{02}+a_{03}" title="f(0,1)=a_{00}+a_{01}+a_{02}+a_{03}" class="latex"></li>
<li><img src="giassia2-Dateien/latex_016.png" alt="f(1,1)=\sum_{m=0}^{3}\sum_{n=0}^{3}a_{mn}=a_{00}+a_{01}+a_{02}+a_{03}+a_{10}+a_{11}+a_{12}+a_{13}+a_{20}+a_{21}+a_{22}+a_{23}+a_{30}+a_{31}+a_{32}+a_{33}" title="f(1,1)=\sum_{m=0}^{3}\sum_{n=0}^{3}a_{mn}=a_{00}+a_{01}+a_{02}+a_{03}+a_{10}+a_{11}+a_{12}+a_{13}+a_{20}+a_{21}+a_{22}+a_{23}+a_{30}+a_{31}+a_{32}+a_{33}" class="latex"></li>
</ul>
</li>
<li>X-Derivatives:
<ul>
<li><img src="giassia2-Dateien/latex_041.png" alt="f_x(0,0)=a_{10}" title="f_x(0,0)=a_{10}" class="latex"></li>
<li><img src="giassia2-Dateien/latex_048.png" alt="f_x(1,0)=a_{10}+2a_{20}+3a_{30}" title="f_x(1,0)=a_{10}+2a_{20}+3a_{30}" class="latex"></li>
<li><img src="giassia2-Dateien/latex_015.png" alt="f_x(0,1)=a_{10}+a_{11}+a_{12}+a_{13}" title="f_x(0,1)=a_{10}+a_{11}+a_{12}+a_{13}" class="latex"></li>
<li><img src="giassia2-Dateien/latex_058.png" alt="f_x(1,1)=\sum_{m=1}^{3}\sum_{n=0}^{3}a_{mn}m" title="f_x(1,1)=\sum_{m=1}^{3}\sum_{n=0}^{3}a_{mn}m" class="latex"></li>
</ul>
</li>
<li>Y-Derivatives:
<ul>
<li><img src="giassia2-Dateien/latex_014.png" alt="f_y(0,0)=a_{01}" title="f_y(0,0)=a_{01}" class="latex"></li>
<li><img src="giassia2-Dateien/latex_050.png" alt="f_y(1,0)=a_{01}+a_{11}+a_{21}+a_{31}" title="f_y(1,0)=a_{01}+a_{11}+a_{21}+a_{31}" class="latex"></li>
<li><img src="giassia2-Dateien/latex_029.png" alt="f_y(0,1)=a_{01}+2a_{02}+3a_{03}" title="f_y(0,1)=a_{01}+2a_{02}+3a_{03}" class="latex"></li>
<li><img src="giassia2-Dateien/latex_052.png" alt="f_y(1,1)=\sum_{m=0}^{3}\sum_{n=1}^{3}a_{mn}n" title="f_y(1,1)=\sum_{m=0}^{3}\sum_{n=1}^{3}a_{mn}n" class="latex"></li>
</ul>
</li>
<li>Cross-Derivatives (XY):
<ul>
<li><img src="giassia2-Dateien/latex_013.png" alt="f_{xy}(0,0)=a_{11}" title="f_{xy}(0,0)=a_{11}" class="latex"></li>
<li><img src="giassia2-Dateien/latex_004.png" alt="f_{xy}(1,0)=a_{11}+2a_{21}+3a_{31}" title="f_{xy}(1,0)=a_{11}+2a_{21}+3a_{31}" class="latex"></li>
<li><img src="giassia2-Dateien/latex_012.png" alt="f_{xy}(0,0)=a_{11}+2a_{12}+3a_{13}" title="f_{xy}(0,0)=a_{11}+2a_{12}+3a_{13}" class="latex"></li>
<li><img src="giassia2-Dateien/latex_019.png" alt="f_{xy}(0,0)=\sum_{m=1}^{3}\sum_{n=1}^{3}a_{mn}mn" title="f_{xy}(0,0)=\sum_{m=1}^{3}\sum_{n=1}^{3}a_{mn}mn" class="latex"></li>
</ul>
</li>
</ul>
<p>These coefficient values, combined with the previously calculated 
partial and cross-derivative values, form a set of linear equations 
which form a matrix equation of the general form <img src="giassia2-Dateien/latex_056.png" alt="Ax=b" title="Ax=b" class="latex">. We will rewrite it in the form <img src="giassia2-Dateien/latex_055.png" alt="M\alpha=\beta" title="M\alpha=\beta" class="latex"> so that we don’t confuse the values for our matrices with those used in the equations above. Let:</p>
<ul>
<li><img src="giassia2-Dateien/latex_032.png" alt="\alpha = \left(\begin{array}{cccccccccccccccc}a_{00}&amp;a_{10}&amp;a_{20}&amp;a_{30}&amp;a_{01}&amp;a_{11}&amp;a_{21}&amp;a_{31}&amp;a_{02}&amp;a_{12}&amp;a_{22}&amp;a_{32}&amp;a_{03}&amp;a_{13}&amp;a_{23}&amp;a_{33}\end{array}\right)^T" title="\alpha = \left(\begin{array}{cccccccccccccccc}a_{00}&amp;a_{10}&amp;a_{20}&amp;a_{30}&amp;a_{01}&amp;a_{11}&amp;a_{21}&amp;a_{31}&amp;a_{02}&amp;a_{12}&amp;a_{22}&amp;a_{32}&amp;a_{03}&amp;a_{13}&amp;a_{23}&amp;a_{33}\end{array}\right)^T" class="latex"></li>
<li><img src="giassia2-Dateien/latex_040.png" alt="\beta =\left(\begin{array}{cccccccccccccccc}f(0,0)&amp;f(1,0)&amp;f(0,1)&amp;f(1,1)&amp;f_x(0,0)&amp;f_x(1,0)&amp;f_x(0,1)&amp;f_x(1,1)&amp;f_y(0,0)&amp;f_y(1,0)&amp;f_y(0,1)&amp;f_y(1,1)&amp;f_{xy}(0,0)&amp;f_{xy}(1,0)&amp;f_{xy}(0,1)&amp;f_{xy}(1,1)\end{array}\right)^T" title="\beta =\left(\begin{array}{cccccccccccccccc}f(0,0)&amp;f(1,0)&amp;f(0,1)&amp;f(1,1)&amp;f_x(0,0)&amp;f_x(1,0)&amp;f_x(0,1)&amp;f_x(1,1)&amp;f_y(0,0)&amp;f_y(1,0)&amp;f_y(0,1)&amp;f_y(1,1)&amp;f_{xy}(0,0)&amp;f_{xy}(1,0)&amp;f_{xy}(0,1)&amp;f_{xy}(1,1)\end{array}\right)^T" class="latex"></li>
<li><img src="giassia2-Dateien/latex_002.png" alt="M=" title="M=" class="latex">
<p></p><div id="attachment_433" style="width: 315px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/M-matrix.png"><img class="size-full wp-image-433" title="M-matrix" src="giassia2-Dateien/M-matrix.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/M-matrix.png 305w, http://www.giassa.net/wp-content/uploads/2009/12/M-matrix-285x300.png 285w" sizes="(max-width: 305px) 100vw, 305px" height="321" width="305"></a><p class="wp-caption-text">Coefficient Matrix for ‘a’-values</p></div></li>
</ul>
<p>Note that the <img src="giassia2-Dateien/latex_034.png" alt="^T" title="^T" class="latex">
 refers to the transpose of these matrices, rather than an exponent 
(which would only make sense for a square matrix anyways). With these 
equations, we can use our favorite method (feel free to pick) of solving
 this set of linear equations to solve for the inverse of our weighting 
matrix, <img src="giassia2-Dateien/latex_025.png" alt="M" title="M" class="latex">.
 Once this is done, we can save this matrix for use in any future 
implementations of bicubic interpolation, as there is no need to 
recalculate it again in the future. By simple matrix inversion (yes, you
 can do this by hand if you really want to, the matrix algebra is very 
simple, just time-consuming; it’d be better to do this with MATLAB), we 
get the inverted coefficient matrix, <img src="giassia2-Dateien/latex_042.png" alt="M^{-1}" title="M^{-1}" class="latex">.</p>
<ul>
<li><img src="giassia2-Dateien/latex_042.png" alt="M^{-1}" title="M^{-1}" class="latex"> =</li>
</ul>
<div id="attachment_434" style="width: 315px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/M-matrix-inverted.png"><img class="size-full wp-image-434" title="M-matrix-inverted" src="giassia2-Dateien/M-matrix-inverted.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/M-matrix-inverted.png 305w, http://www.giassa.net/wp-content/uploads/2009/12/M-matrix-inverted-285x300.png 285w" sizes="(max-width: 305px) 100vw, 305px" height="321" width="305"></a><p class="wp-caption-text">Inverted Coefficient Matrix</p></div>
<p>When <img src="giassia2-Dateien/latex_042.png" alt="M^{-1}" title="M^{-1}" class="latex"> is&nbsp; multiplied (via matrix multiplication of course) with our product matrix, <img src="giassia2-Dateien/latex_045.png" alt="\beta" title="\beta" class="latex">, this gives us the values of each of the 16 coefficients in our <img src="giassia2-Dateien/latex_024.png" alt="\alpha" title="\alpha" class="latex">
 matrix. We can now use the previously defined sigma-notation formula to
 determine the value of any interpolated data point using the formula:</p>
<ul>
<li><img src="giassia2-Dateien/latex_038.png" alt="p(J,K)=\sum_{m=0}^{3}\sum_{n=0}^{3}a_{mn}(1-w)^m(1-h)^n" title="p(J,K)=\sum_{m=0}^{3}\sum_{n=0}^{3}a_{mn}(1-w)^m(1-h)^n" class="latex"></li>
</ul>
<p>The following MATLAB M-function demonstrates this algorithm in action:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57d154ffca7b5055473096" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div style="background-size: 48px 128px; background-image: url(&quot;http://www.giassa.net/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);" class="crayon-button-icon"></div></div><span class="crayon-language">MATLAB</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">% GBI.M
% Written December 2009, (C) Matthew Giassa
% teo@giassa.net, www.giassa.net
% Returns an upsampled image using bicubic interpolation
function output_image = gbi( input_image,x_res,y_res )
%   input_image     -   an image on which to perform bicubic interpolation
%   x_res           -   the new horizontal dimensions (in pixels)
%   y_res           -   the new vertical dimensions (in pixels)
%Define the inverted weighting matrix, M^(-1), no need to recalculate it
%ever again
M_inv = [
 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
 0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0;
 -3,3,0,0,-2,-1,0,0,0,0,0,0,0,0,0,0;
 2,-2,0,0,1,1,0,0,0,0,0,0,0,0,0,0;
 0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0;
 0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0;
 0,0,0,0,0,0,0,0,-3,3,0,0,-2,-1,0,0;
 0,0,0,0,0,0,0,0,2,-2,0,0,1,1,0,0;
 -3,0,3,0,0,0,0,0,-2,0,-1,0,0,0,0,0;
 0,0,0,0,-3,0,3,0,0,0,0,0,-2,0,-1,0;
 9,-9,-9,9,6,3,-6,-3,6,-6,3,-3,4,2,2,1;
 -6,6,6,-6,-3,-3,3,3,-4,4,-2,2,-2,-2,-1,-1;
 2,0,-2,0,0,0,0,0,1,0,1,0,0,0,0,0;
 0,0,0,0,2,0,-2,0,0,0,0,0,1,0,1,0;
 -6,6,6,-6,-4,-2,4,2,-3,3,-3,3,-2,-1,-2,-1;
 4,-4,-4,4,2,2,-2,-2,2,-2,2,-2,1,1,1,1
 ];
%Make a copy of the input image
I = input_image;
%Convert image to grayscale (intensity) values for simplicity (for now)
I = double(rgb2gray(I));
%Determine the dimensions of the source image
%Note that we will have three values - width, height, and the number
%of color vectors, 3
[j k] = size(I);
%Specify the new image dimensions we want for our larger output image
x_new = x_res;
y_new = y_res;
%Determine the ratio of the old dimensions compared to the new dimensions
%Referred to as S1 and S2 in my tutorial
x_scale = x_new./(j-1);
y_scale = y_new./(k-1);
%Declare and initialize an output image buffer
temp_image = zeros(x_new,y_new);
%Calculate the horizontal derivatives for each point (assume that at the
%edge pixels of the source image, all derivatives are zero to maximize
%smoothing). Take note - recreating this in C or C++ might not be so easy,
%as you must pay attention to how this code is using matrix-style
%addressing (x-y positions swapped).
Ix = double(zeros(j,k));
for count1 = 1:j
 for count2 = 1:k
 if( (count2==1) || (count2==k) )
 Ix(count1,count2)=0;
 else
 Ix(count1,count2)=(0.5).*(I(count1,count2+1)-I(count1,count2-1));
 end
 end
end
%Similarly, calculate the vertical derivatives
Iy = double(zeros(j,k));
for count1 = 1:j
 for count2 = 1:k
 if( (count1==1) || (count1==j) )
 Iy(count1,count2)=0;
 else
 Iy(count1,count2)=(0.5).*(I(count1+1,count2)-I(count1-1,count2));
 end
 end
end
%Finally, calculate the cross derivatives
Ixy = double(zeros(j,k));
for count1 = 1:j
 for count2 = 1:k
 if( (count1==1) || (count1==j) || (count2==1) || (count2==k) )
 Ixy(count1,count2)=0;
 else
 Ixy(count1,count2)=(0.25).*((I(count1+1,count2+1)+I(count1-1,count2-1)) - (I(count1+1,count2-1)+I(count1-1,count2+1)));
 end
 end
end
%Generate the output image
%==========================================================================
%Please note that this is definitely not the most efficient way to carry
%out this operation, as we are recalculating our beta and alpha-vectors far
%repeatedly when there is no need. I kept the code like this so you can see
%the order in which we would carry out most operations. If you want to make
%a more efficient version which pre-calculates the alpha vector for each
%pixel in the source image, be my guest.
%==========================================================================
for count1 = 0:x_new-1
 for count2 = 0:y_new-1
 %Calculate the normalized distance constants, h and w
 W = -(((count1./x_scale)-floor(count1./x_scale))-1);
 H = -(((count2./y_scale)-floor(count2./y_scale))-1);
 %Determine the indexes/address of the 4 neighbouring pixels from
 %the source data/image
 I11_index = [1+floor(count1./x_scale),1+floor(count2./y_scale)];
 I21_index = [1+floor(count1./x_scale),1+ceil(count2./y_scale)];
 I12_index = [1+ceil(count1./x_scale),1+floor(count2./y_scale)];
 I22_index = [1+ceil(count1./x_scale),1+ceil(count2./y_scale)];
 %Calculate the four nearest function values
 I11 = I(I11_index(1),I11_index(2));
 I21 = I(I21_index(1),I21_index(2));
 I12 = I(I12_index(1),I12_index(2));
 I22 = I(I22_index(1),I22_index(2));
 %Calculate the four nearest horizontal derivatives
 Ix11 = Ix(I11_index(1),I11_index(2));
 Ix21 = Ix(I21_index(1),I21_index(2));
 Ix12 = Ix(I12_index(1),I12_index(2));
 Ix22 = Ix(I22_index(1),I22_index(2));
 %Calculate the four nearest vertical derivatives
 Iy11 = Iy(I11_index(1),I11_index(2));
 Iy21 = Iy(I21_index(1),I21_index(2));
 Iy12 = Iy(I12_index(1),I12_index(2));
 Iy22 = Iy(I22_index(1),I22_index(2));
 %Calculate the four nearest cross derivatives
 Ixy11 = Ixy(I11_index(1),I11_index(2));
 Ixy21 = Ixy(I21_index(1),I21_index(2));
 Ixy12 = Ixy(I12_index(1),I12_index(2));
 Ixy22 = Ixy(I22_index(1),I22_index(2));
 %Create our beta-vector
 beta = [I11 I21 I12 I22 Ix11 Ix21 Ix12 Ix22 Iy11 Iy21 Iy12 Iy22 Ixy11 Ixy21 Ixy12 Ixy22];
 %Calculate our alpha vector (ie: the a-values) using simple matrix
 %multiplication
 %==================================================================
 %If we wanted to make sure this entire program is written entirely
 %from scratch, we would implement our own code to multiple an AxB
 %matrix and a BxC matrix right here. This is very simple to do, so
 %I won't go over it right now.
 %==================================================================
 alpha = M_inv*beta';
 temp_p=0;
 for count3 = 1:16
 w_temp = floor((count3-1)/4);
 h_temp = mod(count3-1,4);
 %disp(sprintf('aij=%d  wsub=%d   hsub=%d\n',count3,w_temp,h_temp))
 temp_p = temp_p + alpha(count3).*((1-W)^(w_temp)).*((1-H)^(h_temp));
 end
 temp_image(count1+1,count2+1)=temp_p;
 end
end
output_image = temp_image;</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table style="" class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-2">2</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-4">4</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-6">6</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-8">8</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-10">10</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-12">12</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-14">14</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-16">16</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-18">18</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-20">20</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-22">22</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-24">24</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-26">26</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-28">28</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-30">30</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-32">32</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-34">34</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-36">36</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-38">38</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-40">40</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-42">42</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-44">44</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-46">46</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-48">48</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-50">50</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-52">52</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-54">54</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-56">56</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-58">58</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-60">60</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-62">62</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-64">64</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-66">66</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-68">68</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-70">70</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-72">72</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-74">74</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-76">76</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-78">78</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-80">80</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-82">82</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-84">84</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-86">86</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-88">88</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-90">90</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-92">92</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-94">94</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-96">96</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-98">98</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-100">100</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-102">102</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-104">104</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-106">106</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-108">108</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-110">110</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-112">112</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-114">114</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-116">116</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-118">118</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-120">120</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-122">122</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-124">124</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-126">126</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-128">128</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-130">130</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-132">132</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-134">134</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-136">136</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-138">138</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-140">140</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-142">142</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-144">144</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-146">146</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-148">148</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-150">150</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-152">152</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-154">154</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-156">156</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-158">158</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-160">160</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-162">162</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-164">164</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-166">166</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-168">168</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-169">169</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-170">170</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-171">171</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-172">172</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-173">173</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-174">174</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-175">175</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-176">176</div><div class="crayon-num" data-line="crayon-57d154ffca7b5055473096-177">177</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d154ffca7b5055473096-178">178</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57d154ffca7b5055473096-1"><span class="crayon-ta">%</span><span class="crayon-h"> </span><span class="crayon-v">GBI</span><span class="crayon-sy">.</span><span class="crayon-i">M</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-2">&nbsp;</div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-3"><span class="crayon-ta">%</span><span class="crayon-h"> </span><span class="crayon-i">Written</span><span class="crayon-h"> </span><span class="crayon-i">December</span><span class="crayon-h"> </span><span class="crayon-cn">2009</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">C</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">Matthew</span><span class="crayon-h"> </span><span class="crayon-i">Giassa</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-4">&nbsp;</div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-5"><span class="crayon-ta">%</span><span class="crayon-h"> </span><span class="crayon-v">teo</span><span class="crayon-v">@giassa</span><span class="crayon-sy">.</span><span class="crayon-v">net</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">www</span><span class="crayon-sy">.</span><span class="crayon-v">giassa</span><span class="crayon-sy">.</span><span class="crayon-i">net</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-6">&nbsp;</div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-7"><span class="crayon-ta">%</span><span class="crayon-h"> </span><span class="crayon-i">Returns</span><span class="crayon-h"> </span><span class="crayon-i">an</span><span class="crayon-h"> </span><span class="crayon-i">upsampled</span><span class="crayon-h"> </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-i">using</span><span class="crayon-h"> </span><span class="crayon-i">bicubic</span><span class="crayon-h"> </span><span class="crayon-i">interpolation</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-8">&nbsp;</div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-9"><span class="crayon-st">function</span><span class="crayon-h"> </span><span class="crayon-i">output_image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">gbi</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">input_image</span><span class="crayon-sy">,</span><span class="crayon-i">x_res</span><span class="crayon-sy">,</span><span class="crayon-i">y_res</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-10"><span class="crayon-ta">%</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">input_image</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">-</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">an</span><span class="crayon-h"> </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-i">on</span><span class="crayon-h"> </span><span class="crayon-i">which</span><span class="crayon-h"> </span><span class="crayon-i">to</span><span class="crayon-h"> </span><span class="crayon-i">perform</span><span class="crayon-h"> </span><span class="crayon-i">bicubic</span><span class="crayon-h"> </span><span class="crayon-i">interpolation</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-12"><span class="crayon-ta">%</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">x_res</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">-</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">new</span><span class="crayon-h"> </span><span class="crayon-i">horizontal</span><span class="crayon-h"> </span><span class="crayon-e">dimensions</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-14"><span class="crayon-ta">%</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">y_res</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">-</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">new</span><span class="crayon-h"> </span><span class="crayon-i">vertical</span><span class="crayon-h"> </span><span class="crayon-e">dimensions</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-16"><span class="crayon-ta">%</span><span class="crayon-i">Define</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">inverted</span><span class="crayon-h"> </span><span class="crayon-i">weighting</span><span class="crayon-h"> </span><span class="crayon-v">matrix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">M</span><span class="crayon-o">^</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">no</span><span class="crayon-h"> </span><span class="crayon-i">need</span><span class="crayon-h"> </span><span class="crayon-i">to</span><span class="crayon-h"> </span><span class="crayon-i">recalculate</span><span class="crayon-h"> </span><span class="crayon-i">it</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-18"><span class="crayon-ta">%</span><span class="crayon-i">ever</span><span class="crayon-h"> </span><span class="crayon-i">again</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-20"><span class="crayon-i">M_inv</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-21"><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-22"><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-23"><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-24"><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-25"><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-26"><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-27"><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-28"><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-29"><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-30"><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-31"><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-32"><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-33"><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-34"><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-35"><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-36"><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-37"><span class="crayon-h"> </span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-38"><span class="crayon-ta">%</span><span class="crayon-i">Make</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-i">copy</span><span class="crayon-h"> </span><span class="crayon-i">of</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">input</span><span class="crayon-h"> </span><span class="crayon-i">image</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-40"><span class="crayon-r ">I</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">input_image</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-41"><span class="crayon-ta">%</span><span class="crayon-i">Convert</span><span class="crayon-h"> </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-i">to</span><span class="crayon-h"> </span><span class="crayon-e">grayscale</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">intensity</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">values</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">simplicity</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">now</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-42">&nbsp;</div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-43"><span class="crayon-r ">I</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">double</span><span class="crayon-sy">(</span><span class="crayon-r">rgb2gray</span><span class="crayon-sy">(</span><span class="crayon-r ">I</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-44"><span class="crayon-ta">%</span><span class="crayon-i">Determine</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">dimensions</span><span class="crayon-h"> </span><span class="crayon-i">of</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">source</span><span class="crayon-h"> </span><span class="crayon-i">image</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-45">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-46"><span class="crayon-ta">%</span><span class="crayon-i">Note</span><span class="crayon-h"> </span><span class="crayon-i">that</span><span class="crayon-h"> </span><span class="crayon-i">we</span><span class="crayon-h"> </span><span class="crayon-i">will</span><span class="crayon-h"> </span><span class="crayon-i">have</span><span class="crayon-h"> </span><span class="crayon-i">three</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">height</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">number</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-47">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-48"><span class="crayon-ta">%</span><span class="crayon-i">of</span><span class="crayon-h"> </span><span class="crayon-i">color</span><span class="crayon-h"> </span><span class="crayon-v">vectors</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-49">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-50"><span class="crayon-sy">[</span><span class="crayon-r ">j</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">size</span><span class="crayon-sy">(</span><span class="crayon-r ">I</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-51"><span class="crayon-ta">%</span><span class="crayon-i">Specify</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">new</span><span class="crayon-h"> </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-i">dimensions</span><span class="crayon-h"> </span><span class="crayon-i">we</span><span class="crayon-h"> </span><span class="crayon-i">want</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">our</span><span class="crayon-h"> </span><span class="crayon-i">larger</span><span class="crayon-h"> </span><span class="crayon-i">output</span><span class="crayon-h"> </span><span class="crayon-i">image</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-52">&nbsp;</div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-53"><span class="crayon-i">x_new</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">x_res</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-54"><span class="crayon-i">y_new</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">y_res</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-55"><span class="crayon-ta">%</span><span class="crayon-i">Determine</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">ratio</span><span class="crayon-h"> </span><span class="crayon-i">of</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">old</span><span class="crayon-h"> </span><span class="crayon-i">dimensions</span><span class="crayon-h"> </span><span class="crayon-i">compared</span><span class="crayon-h"> </span><span class="crayon-i">to</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">new</span><span class="crayon-h"> </span><span class="crayon-i">dimensions</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-56">&nbsp;</div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-57"><span class="crayon-ta">%</span><span class="crayon-i">Referred</span><span class="crayon-h"> </span><span class="crayon-i">to</span><span class="crayon-h"> </span><span class="crayon-i">as</span><span class="crayon-h"> </span><span class="crayon-i">S1</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-i">S2</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-i">my</span><span class="crayon-h"> </span><span class="crayon-i">tutorial</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-58">&nbsp;</div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-59"><span class="crayon-i">x_scale</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">x_new</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-60"><span class="crayon-i">y_scale</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">y_new</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-sy">(</span><span class="crayon-i">k</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-61"><span class="crayon-ta">%</span><span class="crayon-i">Declare</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-i">initialize</span><span class="crayon-h"> </span><span class="crayon-i">an</span><span class="crayon-h"> </span><span class="crayon-i">output</span><span class="crayon-h"> </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-i">buffer</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-62">&nbsp;</div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-63"><span class="crayon-i">temp_image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">zeros</span><span class="crayon-sy">(</span><span class="crayon-i">x_new</span><span class="crayon-sy">,</span><span class="crayon-i">y_new</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-64"><span class="crayon-ta">%</span><span class="crayon-i">Calculate</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">horizontal</span><span class="crayon-h"> </span><span class="crayon-i">derivatives</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">each</span><span class="crayon-h"> </span><span class="crayon-i">point</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">assume</span><span class="crayon-h"> </span><span class="crayon-i">that</span><span class="crayon-h"> </span><span class="crayon-i">at</span><span class="crayon-h"> </span><span class="crayon-i">the</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-65">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-66"><span class="crayon-ta">%</span><span class="crayon-i">edge</span><span class="crayon-h"> </span><span class="crayon-i">pixels</span><span class="crayon-h"> </span><span class="crayon-i">of</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">source</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">all</span><span class="crayon-h"> </span><span class="crayon-i">derivatives</span><span class="crayon-h"> </span><span class="crayon-i">are</span><span class="crayon-h"> </span><span class="crayon-i">zero</span><span class="crayon-h"> </span><span class="crayon-i">to</span><span class="crayon-h"> </span><span class="crayon-i">maximize</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-67">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-68"><span class="crayon-ta">%</span><span class="crayon-v">smoothing</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-i">Take</span><span class="crayon-h"> </span><span class="crayon-v">note</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">recreating</span><span class="crayon-h"> </span><span class="crayon-i">this</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-i">C</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-v">C</span><span class="crayon-o">++</span><span class="crayon-h"> </span><span class="crayon-i">might</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-i">be</span><span class="crayon-h"> </span><span class="crayon-i">so</span><span class="crayon-h"> </span><span class="crayon-v">easy</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-69">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-70"><span class="crayon-ta">%</span><span class="crayon-i">as</span><span class="crayon-h"> </span><span class="crayon-i">you</span><span class="crayon-h"> </span><span class="crayon-i">must</span><span class="crayon-h"> </span><span class="crayon-i">pay</span><span class="crayon-h"> </span><span class="crayon-i">attention</span><span class="crayon-h"> </span><span class="crayon-i">to</span><span class="crayon-h"> </span><span class="crayon-i">how</span><span class="crayon-h"> </span><span class="crayon-i">this</span><span class="crayon-h"> </span><span class="crayon-i">code</span><span class="crayon-h"> </span><span class="crayon-i">is</span><span class="crayon-h"> </span><span class="crayon-i">using</span><span class="crayon-h"> </span><span class="crayon-v">matrix</span><span class="crayon-o">-</span><span class="crayon-i">style</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-71">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-72"><span class="crayon-ta">%</span><span class="crayon-e">addressing</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">-</span><span class="crayon-i">y</span><span class="crayon-h"> </span><span class="crayon-i">positions</span><span class="crayon-h"> </span><span class="crayon-v">swapped</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-73">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-74"><span class="crayon-i">Ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">double</span><span class="crayon-sy">(</span><span class="crayon-r">zeros</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">,</span><span class="crayon-i">k</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-75"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">count1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-r ">j</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-76"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">count2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-i">k</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-77"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">count2</span><span class="crayon-o">==</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">count2</span><span class="crayon-o">==</span><span class="crayon-i">k</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-78"><span class="crayon-h"> </span><span class="crayon-r">Ix</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-sy">,</span><span class="crayon-i">count2</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-79"><span class="crayon-h"> </span><span class="crayon-st">else</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-80"><span class="crayon-h"> </span><span class="crayon-r">Ix</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-sy">,</span><span class="crayon-i">count2</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-r">I</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-sy">,</span><span class="crayon-i">count2</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">I</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-sy">,</span><span class="crayon-i">count2</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-81"><span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-82"><span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-83"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-84"><span class="crayon-ta">%</span><span class="crayon-v">Similarly</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">calculate</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">vertical</span><span class="crayon-h"> </span><span class="crayon-i">derivatives</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-85">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-86"><span class="crayon-i">Iy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">double</span><span class="crayon-sy">(</span><span class="crayon-r">zeros</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">,</span><span class="crayon-i">k</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-87"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">count1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-r ">j</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-88"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">count2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-i">k</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-89"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-o">==</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-o">==</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-90"><span class="crayon-h"> </span><span class="crayon-r">Iy</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-sy">,</span><span class="crayon-i">count2</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-91"><span class="crayon-h"> </span><span class="crayon-st">else</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-92"><span class="crayon-h"> </span><span class="crayon-r">Iy</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-sy">,</span><span class="crayon-i">count2</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-r">I</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-i">count2</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">I</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-i">count2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-93"><span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-94"><span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-95"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-96"><span class="crayon-ta">%</span><span class="crayon-v">Finally</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">calculate</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">cross</span><span class="crayon-h"> </span><span class="crayon-i">derivatives</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-97">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-98"><span class="crayon-i">Ixy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">double</span><span class="crayon-sy">(</span><span class="crayon-r">zeros</span><span class="crayon-sy">(</span><span class="crayon-r ">j</span><span class="crayon-sy">,</span><span class="crayon-i">k</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-99"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">count1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-r ">j</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-100"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">count2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-i">k</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-101"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-o">==</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-o">==</span><span class="crayon-r ">j</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">count2</span><span class="crayon-o">==</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">count2</span><span class="crayon-o">==</span><span class="crayon-i">k</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-102"><span class="crayon-h"> </span><span class="crayon-r">Ixy</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-sy">,</span><span class="crayon-i">count2</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-103"><span class="crayon-h"> </span><span class="crayon-st">else</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-104"><span class="crayon-h"> </span><span class="crayon-r">Ixy</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-sy">,</span><span class="crayon-i">count2</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0.25</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-r">I</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-i">count2</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-r">I</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-i">count2</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-r">I</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-i">count2</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-r">I</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-i">count2</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-105"><span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-106"><span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-107"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-108"><span class="crayon-ta">%</span><span class="crayon-i">Generate</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">output</span><span class="crayon-h"> </span><span class="crayon-i">image</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-109">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-110"><span class="crayon-ta">%</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">==</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-111">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-112"><span class="crayon-ta">%</span><span class="crayon-i">Please</span><span class="crayon-h"> </span><span class="crayon-i">note</span><span class="crayon-h"> </span><span class="crayon-i">that</span><span class="crayon-h"> </span><span class="crayon-i">this</span><span class="crayon-h"> </span><span class="crayon-i">is</span><span class="crayon-h"> </span><span class="crayon-i">definitely</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">most</span><span class="crayon-h"> </span><span class="crayon-i">efficient</span><span class="crayon-h"> </span><span class="crayon-i">way</span><span class="crayon-h"> </span><span class="crayon-i">to</span><span class="crayon-h"> </span><span class="crayon-i">carry</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-113">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-114"><span class="crayon-ta">%</span><span class="crayon-i">out</span><span class="crayon-h"> </span><span class="crayon-i">this</span><span class="crayon-h"> </span><span class="crayon-v">operation</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">as</span><span class="crayon-h"> </span><span class="crayon-i">we</span><span class="crayon-h"> </span><span class="crayon-i">are</span><span class="crayon-h"> </span><span class="crayon-i">recalculating</span><span class="crayon-h"> </span><span class="crayon-i">our</span><span class="crayon-h"> </span><span class="crayon-i">beta</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">-</span><span class="crayon-i">vectors</span><span class="crayon-h"> </span><span class="crayon-i">far</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-115">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-116"><span class="crayon-ta">%</span><span class="crayon-i">repeatedly</span><span class="crayon-h"> </span><span class="crayon-st">when</span><span class="crayon-h"> </span><span class="crayon-i">there</span><span class="crayon-h"> </span><span class="crayon-i">is</span><span class="crayon-h"> </span><span class="crayon-i">no</span><span class="crayon-h"> </span><span class="crayon-v">need</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-i">I</span><span class="crayon-h"> </span><span class="crayon-i">kept</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">code</span><span class="crayon-h"> </span><span class="crayon-i">like</span><span class="crayon-h"> </span><span class="crayon-i">this</span><span class="crayon-h"> </span><span class="crayon-i">so</span><span class="crayon-h"> </span><span class="crayon-i">you</span><span class="crayon-h"> </span><span class="crayon-i">can</span><span class="crayon-h"> </span><span class="crayon-i">see</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-117">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-118"><span class="crayon-ta">%</span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">order</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-i">which</span><span class="crayon-h"> </span><span class="crayon-i">we</span><span class="crayon-h"> </span><span class="crayon-i">would</span><span class="crayon-h"> </span><span class="crayon-i">carry</span><span class="crayon-h"> </span><span class="crayon-i">out</span><span class="crayon-h"> </span><span class="crayon-i">most</span><span class="crayon-h"> </span><span class="crayon-v">operations</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-st">If</span><span class="crayon-h"> </span><span class="crayon-i">you</span><span class="crayon-h"> </span><span class="crayon-i">want</span><span class="crayon-h"> </span><span class="crayon-i">to</span><span class="crayon-h"> </span><span class="crayon-i">make</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-119">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-120"><span class="crayon-ta">%</span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-i">more</span><span class="crayon-h"> </span><span class="crayon-i">efficient</span><span class="crayon-h"> </span><span class="crayon-i">version</span><span class="crayon-h"> </span><span class="crayon-i">which</span><span class="crayon-h"> </span><span class="crayon-v">pre</span><span class="crayon-o">-</span><span class="crayon-i">calculates</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">alpha</span><span class="crayon-h"> </span><span class="crayon-i">vector</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">each</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-121">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-122"><span class="crayon-ta">%</span><span class="crayon-i">pixel</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-i">source</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">be</span><span class="crayon-h"> </span><span class="crayon-i">my</span><span class="crayon-h"> </span><span class="crayon-v">guest</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-123">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-124"><span class="crayon-ta">%</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">==</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-125">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-126"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">count1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-i">x_new</span><span class="crayon-o">-</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-127"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">count2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-i">y_new</span><span class="crayon-o">-</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-128"><span class="crayon-h"> </span><span class="crayon-c">%Calculate the normalized distance constants, h and w</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-129"><span class="crayon-h"> </span><span class="crayon-i">W</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-i">x_scale</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">floor</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-i">x_scale</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-130"><span class="crayon-h"> </span><span class="crayon-i">H</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-i">count2</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-i">y_scale</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-r">floor</span><span class="crayon-sy">(</span><span class="crayon-i">count2</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-i">y_scale</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-131"><span class="crayon-h"> </span><span class="crayon-c">%Determine the indexes/address of the 4 neighbouring pixels from</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-132"><span class="crayon-h"> </span><span class="crayon-c">%the source data/image</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-133"><span class="crayon-h"> </span><span class="crayon-i">I11_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">+</span><span class="crayon-r">floor</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-i">x_scale</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-o">+</span><span class="crayon-r">floor</span><span class="crayon-sy">(</span><span class="crayon-i">count2</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-i">y_scale</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-134"><span class="crayon-h"> </span><span class="crayon-i">I21_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">+</span><span class="crayon-r">floor</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-i">x_scale</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-o">+</span><span class="crayon-r">ceil</span><span class="crayon-sy">(</span><span class="crayon-i">count2</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-i">y_scale</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-135"><span class="crayon-h"> </span><span class="crayon-i">I12_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">+</span><span class="crayon-r">ceil</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-i">x_scale</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-o">+</span><span class="crayon-r">floor</span><span class="crayon-sy">(</span><span class="crayon-i">count2</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-i">y_scale</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-136"><span class="crayon-h"> </span><span class="crayon-i">I22_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">+</span><span class="crayon-r">ceil</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-i">x_scale</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-o">+</span><span class="crayon-r">ceil</span><span class="crayon-sy">(</span><span class="crayon-i">count2</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-i">y_scale</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-137"><span class="crayon-h"> </span><span class="crayon-c">%Calculate the four nearest function values</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-138"><span class="crayon-h"> </span><span class="crayon-i">I11</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">I</span><span class="crayon-sy">(</span><span class="crayon-r">I11_index</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-r">I11_index</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-139"><span class="crayon-h"> </span><span class="crayon-i">I21</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">I</span><span class="crayon-sy">(</span><span class="crayon-r">I21_index</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-r">I21_index</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-140"><span class="crayon-h"> </span><span class="crayon-i">I12</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">I</span><span class="crayon-sy">(</span><span class="crayon-r">I12_index</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-r">I12_index</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-141"><span class="crayon-h"> </span><span class="crayon-i">I22</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">I</span><span class="crayon-sy">(</span><span class="crayon-r">I22_index</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-r">I22_index</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-142"><span class="crayon-h"> </span><span class="crayon-c">%Calculate the four nearest horizontal derivatives</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-143"><span class="crayon-h"> </span><span class="crayon-i">Ix11</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">Ix</span><span class="crayon-sy">(</span><span class="crayon-r">I11_index</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-r">I11_index</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-144"><span class="crayon-h"> </span><span class="crayon-i">Ix21</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">Ix</span><span class="crayon-sy">(</span><span class="crayon-r">I21_index</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-r">I21_index</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-145"><span class="crayon-h"> </span><span class="crayon-i">Ix12</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">Ix</span><span class="crayon-sy">(</span><span class="crayon-r">I12_index</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-r">I12_index</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-146"><span class="crayon-h"> </span><span class="crayon-i">Ix22</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">Ix</span><span class="crayon-sy">(</span><span class="crayon-r">I22_index</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-r">I22_index</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-147"><span class="crayon-h"> </span><span class="crayon-c">%Calculate the four nearest vertical derivatives</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-148"><span class="crayon-h"> </span><span class="crayon-i">Iy11</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">Iy</span><span class="crayon-sy">(</span><span class="crayon-r">I11_index</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-r">I11_index</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-149"><span class="crayon-h"> </span><span class="crayon-i">Iy21</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">Iy</span><span class="crayon-sy">(</span><span class="crayon-r">I21_index</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-r">I21_index</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-150"><span class="crayon-h"> </span><span class="crayon-i">Iy12</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">Iy</span><span class="crayon-sy">(</span><span class="crayon-r">I12_index</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-r">I12_index</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-151"><span class="crayon-h"> </span><span class="crayon-i">Iy22</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">Iy</span><span class="crayon-sy">(</span><span class="crayon-r">I22_index</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-r">I22_index</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-152"><span class="crayon-h"> </span><span class="crayon-c">%Calculate the four nearest cross derivatives</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-153"><span class="crayon-h"> </span><span class="crayon-i">Ixy11</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">Ixy</span><span class="crayon-sy">(</span><span class="crayon-r">I11_index</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-r">I11_index</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-154"><span class="crayon-h"> </span><span class="crayon-i">Ixy21</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">Ixy</span><span class="crayon-sy">(</span><span class="crayon-r">I21_index</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-r">I21_index</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-155"><span class="crayon-h"> </span><span class="crayon-i">Ixy12</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">Ixy</span><span class="crayon-sy">(</span><span class="crayon-r">I12_index</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-r">I12_index</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-156"><span class="crayon-h"> </span><span class="crayon-i">Ixy22</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">Ixy</span><span class="crayon-sy">(</span><span class="crayon-r">I22_index</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-r">I22_index</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-157"><span class="crayon-h"> </span><span class="crayon-c">%Create our beta-vector</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-158"><span class="crayon-h"> </span><span class="crayon-r ">beta</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">I11 </span><span class="crayon-e">I21 </span><span class="crayon-e">I12 </span><span class="crayon-e">I22 </span><span class="crayon-e">Ix11 </span><span class="crayon-e">Ix21 </span><span class="crayon-e">Ix12 </span><span class="crayon-e">Ix22 </span><span class="crayon-e">Iy11 </span><span class="crayon-e">Iy21 </span><span class="crayon-e">Iy12 </span><span class="crayon-e">Iy22 </span><span class="crayon-e">Ixy11 </span><span class="crayon-e">Ixy21 </span><span class="crayon-e">Ixy12 </span><span class="crayon-i">Ixy22</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-159"><span class="crayon-h"> </span><span class="crayon-c">%Calculate our alpha vector (ie: the a-values) using simple matrix</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-160"><span class="crayon-h"> </span><span class="crayon-c">%multiplication</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-161"><span class="crayon-h"> </span><span class="crayon-c">%==================================================================</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-162"><span class="crayon-h"> </span><span class="crayon-c">%If we wanted to make sure this entire program is written entirely</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-163"><span class="crayon-h"> </span><span class="crayon-c">%from scratch, we would implement our own code to multiple an AxB</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-164"><span class="crayon-h"> </span><span class="crayon-c">%matrix and a BxC matrix right here. This is very simple to do, so</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-165"><span class="crayon-h"> </span><span class="crayon-c">%I won't go over it right now.</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-166"><span class="crayon-h"> </span><span class="crayon-c">%==================================================================</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-167"><span class="crayon-h"> </span><span class="crayon-i">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">M_inv</span><span class="crayon-o">*</span><span class="crayon-r ">beta</span><span class="crayon-s">';</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-168"><span class="crayon-s"> temp_p=0;</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-169"><span class="crayon-s"> for count3 = 1:16</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-170"><span class="crayon-s"> w_temp = floor((count3-1)/4);</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-171"><span class="crayon-s"> h_temp = mod(count3-1,4);</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-172"><span class="crayon-s"> %disp(sprintf('</span><span class="crayon-i">aij</span><span class="crayon-o">=</span><span class="crayon-c">%d&nbsp;&nbsp;wsub=%d&nbsp;&nbsp; hsub=%d\n',count3,w_temp,h_temp))</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-173"><span class="crayon-h"> </span><span class="crayon-i">temp_p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">temp_p</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-r">alpha</span><span class="crayon-sy">(</span><span class="crayon-i">count3</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-i">W</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-sy">(</span><span class="crayon-i">w_temp</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-i">H</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-sy">(</span><span class="crayon-i">h_temp</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-174"><span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-175"><span class="crayon-h"> </span><span class="crayon-r">temp_image</span><span class="crayon-sy">(</span><span class="crayon-i">count1</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-i">count2</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-i">temp_p</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-176"><span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-57d154ffca7b5055473096-177"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d154ffca7b5055473096-178"><span class="crayon-i">output_image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">temp_image</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0879 seconds] -->
<p>&nbsp;</p>
<p>Included below is a simple resampling of a 4×4 checkerboard pattern to a much larger resolution using the code above.</p>
<div id="attachment_440" style="width: 310px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/bci-mine.png"><img class="size-medium wp-image-440" title="bci-mine" src="giassia2-Dateien/bci-mine-300x265.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/bci-mine-300x265.png 300w, http://www.giassa.net/wp-content/uploads/2009/12/bci-mine.png 568w" sizes="(max-width: 300px) 100vw, 300px" height="265" width="300"></a><p class="wp-caption-text">Bicubic Interpolation on 4×4 Checkerboard Pattern</p></div>
<p>Before concluding this section, I should note that there are many 
other resampling methods that are definitely worth reading up on, such 
as Lanczos, Hermite spline, Super Eagle, 2xSAI, HQn, and so on. Many of 
these algorithms are used in commerical products such as image 
processing software digital cameras, even console emulators. I will now 
conclude this section with a brief comparison of “bicubic spline 
interpolation” and “generalized bicubic interpolation”, and will show 
why the two are <strong>NOT</strong> the same.</p>
<p>First, observe the image pairs below. The first pair was generated by
 using bicubic spline interpolation, which was covered in the previous 
subsection, while the latter pair was generated with the generalized 
bicubic interpolation algorithm covered in this subsection (the two 
original smiley faces used are slightly different, but no matter):</p>
<div id="attachment_442" style="width: 310px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/smile-halo1.png"><img class="size-medium wp-image-442" title="smile-halo" src="giassia2-Dateien/smile-halo1-300x209.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/smile-halo1-300x209.png 300w, http://www.giassa.net/wp-content/uploads/2009/12/smile-halo1.png 656w" sizes="(max-width: 300px) 100vw, 300px" height="209" width="300"></a><p class="wp-caption-text">Resampling Using Bicubic Spline Interpolation</p></div>
<div id="attachment_441" style="width: 310px" class="wp-caption aligncenter"><a href="http://www.giassa.net/wp-content/uploads/2009/12/smile-bci.png"><img class="size-medium wp-image-441" title="smile-bci" src="giassia2-Dateien/smile-bci-300x202.png" alt="" srcset="http://www.giassa.net/wp-content/uploads/2009/12/smile-bci-300x202.png 300w, http://www.giassa.net/wp-content/uploads/2009/12/smile-bci.png 843w" sizes="(max-width: 300px) 100vw, 300px" height="202" width="300"></a><p class="wp-caption-text">Resampling Using Generalized Bicubic Interpolation</p></div>
<p>If we observe the resampling smiley faces, we can see that both still
 have halos introduced due to our choice of resampling algorithms. One 
important difference exists between both of the sampled images, however –
 the former of the two (generated using bicubic spline interpolation) 
still demonstrates some sharp edges and even corners, while the latter 
does not. This is due to bicubic spline interpolation being a rough 
approximation of generalized bicubic interpolation at best, primarily 
due to it not making any use of the cross-derivatives of the source 
data.</p>
<h1>References</h1>
<p>[1] <em>Numerical recipes in C the art of scientific computing</em>. Cambridge: Cambridge UP, 1992. Print.</p>
			</div><!-- .entry-content -->
	<footer class="entry-meta">
			</footer><!-- .entry-meta -->
</article><!-- #post-371 -->

						<div id="comments">
	
	
			<h2 id="comments-title">
			6 thoughts on “<span>IV – Generalized Bicubic Interpolation</span>”		</h2>

		
		<ol class="commentlist">
				<li class="comment even thread-even depth-1" id="li-comment-289">
		<article id="comment-289" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt="" src="giassia2-Dateien/a_002.jpeg" srcset="http://0.gravatar.com/avatar/?s=136&amp;d=mm&amp;r=g 2x" class="avatar avatar-68 photo avatar-default" height="68" width="68"><span class="fn">lovemoi</span> on <a href="http://www.giassa.net/?page_id=371#comment-289"><time datetime="2010-04-22T05:34:49+00:00">April 22, 2010 at 5:34 am</time></a> <span class="says">said:</span>
									</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>Thanks for your help.</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="http://www.giassa.net/?page_id=371&amp;replytocom=289#respond" onclick='return addComment.moveForm( "comment-289", "289", "respond", "371" )' aria-label="Reply to lovemoi">Reply <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-299">
		<article id="comment-299" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt="" src="giassia2-Dateien/a.jpeg" srcset="http://1.gravatar.com/avatar/?s=136&amp;d=mm&amp;r=g 2x" class="avatar avatar-68 photo avatar-default" height="68" width="68"><span class="fn">turfirmspb</span> on <a href="http://www.giassa.net/?page_id=371#comment-299"><time datetime="2010-04-24T18:25:38+00:00">April 24, 2010 at 6:25 pm</time></a> <span class="says">said:</span>
									</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>Thank you for the help with this.</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="http://www.giassa.net/?page_id=371&amp;replytocom=299#respond" onclick='return addComment.moveForm( "comment-299", "299", "respond", "371" )' aria-label="Reply to turfirmspb">Reply <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-300">
		<article id="comment-300" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt="" src="giassia2-Dateien/a.jpeg" srcset="http://0.gravatar.com/avatar/?s=136&amp;d=mm&amp;r=g 2x" class="avatar avatar-68 photo avatar-default" height="68" width="68"><span class="fn">estro</span> on <a href="http://www.giassa.net/?page_id=371#comment-300"><time datetime="2010-04-25T06:10:10+00:00">April 25, 2010 at 6:10 am</time></a> <span class="says">said:</span>
									</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>what next?</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="http://www.giassa.net/?page_id=371&amp;replytocom=300#respond" onclick='return addComment.moveForm( "comment-300", "300", "respond", "371" )' aria-label="Reply to estro">Reply <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-307">
		<article id="comment-307" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt="" src="giassia2-Dateien/a_003.jpeg" srcset="http://2.gravatar.com/avatar/?s=136&amp;d=mm&amp;r=g 2x" class="avatar avatar-68 photo avatar-default" height="68" width="68"><span class="fn">alex</span> on <a href="http://www.giassa.net/?page_id=371#comment-307"><time datetime="2010-04-26T20:13:13+00:00">April 26, 2010 at 8:13 pm</time></a> <span class="says">said:</span>
									</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>super!</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="http://www.giassa.net/?page_id=371&amp;replytocom=307#respond" onclick='return addComment.moveForm( "comment-307", "307", "respond", "371" )' aria-label="Reply to alex">Reply <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-2086">
		<article id="comment-2086" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt="" src="giassia2-Dateien/ec2987a7e5d1098a19b555a9b23a551b.jpeg" srcset="http://2.gravatar.com/avatar/ec2987a7e5d1098a19b555a9b23a551b?s=136&amp;d=mm&amp;r=g 2x" class="avatar avatar-68 photo" height="68" width="68"><span class="fn">jackson kurotamuno</span> on <a href="http://www.giassa.net/?page_id=371#comment-2086"><time datetime="2010-09-28T17:02:10+00:00">September 28, 2010 at 5:02 pm</time></a> <span class="says">said:</span>
									</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>i am currently researching on use of 
generalised bi-cubic interpolation to compute minimum residues in the 
datum transformation parameters in a first order geodetic network. 
please, i need more information on the use of this method of 
interpolation and that of kriging interpolation strategy. thanks</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="http://www.giassa.net/?page_id=371&amp;replytocom=2086#respond" onclick='return addComment.moveForm( "comment-2086", "2086", "respond", "371" )' aria-label="Reply to jackson kurotamuno">Reply <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-2114">
		<article id="comment-2114" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt="" src="giassia2-Dateien/96f9999b88dcc150b8baee5969633369.jpeg" srcset="http://0.gravatar.com/avatar/96f9999b88dcc150b8baee5969633369?s=136&amp;d=mm&amp;r=g 2x" class="avatar avatar-68 photo" height="68" width="68"><span class="fn">Yuri</span> on <a href="http://www.giassa.net/?page_id=371#comment-2114"><time datetime="2010-10-12T12:44:25+00:00">October 12, 2010 at 12:44 pm</time></a> <span class="says">said:</span>
									</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>Hi there,<br>
I suppose that x_scale and y_scale should be a ratio of either 
(dimensions) or (dimensions-1). In your code they are dimNew/(dimOld-1).
 Check what happens if you keep both dimensions the same – in your case 
pixel values change, although they shouldn’t.<br>
I think that it should be dimNew/dimOld, because in this case doubling 
the image size keeps W and H equal only to 1’s and 0.5’s, ie exactly 
what they must be equal to. Haven’t checked the math, though…</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="http://www.giassa.net/?page_id=371&amp;replytocom=2114#respond" onclick='return addComment.moveForm( "comment-2114", "2114", "respond", "371" )' aria-label="Reply to Yuri">Reply <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
		</ol>

		
		
	
					<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://www.giassa.net/?page_id=371#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="http://www.giassa.net/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" size="30" maxlength="245" aria-required="true" required="required" type="text"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" size="30" maxlength="100" aria-describedby="email-notes" aria-required="true" required="required" type="text"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" size="30" maxlength="200" type="text"></p>
<p class="form-submit"><input name="submit" id="submit" class="submit" value="Post Comment" type="submit"> <input name="comment_post_ID" value="371" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="44ad85df82" type="hidden"></p><p style="display: none;"></p>				<input id="ak_js" name="ak_js" value="1473336576649" type="hidden"></form>
					</div><!-- #respond -->
		
</div><!-- #comments -->

				
			</div><!-- #content -->
		</div><!-- #primary -->


	</div><!-- #main -->

	<footer id="colophon" role="contentinfo">

			

			<div id="site-generator">
								<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform">Proudly powered by WordPress</a>
			</div>
	</footer><!-- #colophon -->
</div><!-- #page -->

<script type="text/javascript" src="giassia2-Dateien/form.js"></script>
<script type="text/javascript" src="giassia2-Dateien/comment-reply.js"></script>
<script type="text/javascript" src="giassia2-Dateien/wp-embed.js"></script>


</body></html>